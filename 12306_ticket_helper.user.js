
// ==UserScript==
// @name 			12306 订票助手(UserScript)
// @namespace		http://www.u-tide.com/fish/
// @author			iFish@FishLee.net <ifish@fishlee.net> http://www.fishlee.net/
// @developer		iFish
// @contributor		
// @description		帮你订票的小助手 :-)
// @match			http://dynamic.12306.cn/otsweb/*
// @match			https://dynamic.12306.cn/otsweb/*
// @match			https://www.12306.cn/otsweb/*
// @icon			http://www.12306.cn/mormhweb/images/favicon.ico
// @run-at			document-idle
// @version 		5.3.2
// @updateURL		http://static.fishlee.net/_softdownload/12306_ticket_helper.user.js
// @supportURL		http://www.fishlee.net/soft/44/
// @homepage		http://www.fishlee.net/soft/44/
// @contributionURL	https://me.alipay.com/imfish
// @contributionAmount	￥5.00
// ==/UserScript==

//=======START=======
/*!
 *		12306 订票助手 for Chrome/Firefox/Liebao/Maxthon
 *				BY 木鱼(iFish) fishcn@foxmail.com
 *					官方网站 http://www.fishlee.net/
 *
 *		感谢您的使用，希望能帮助到您买票。
 *		保留所有版权，欢迎学习探讨，但禁止复制部分或任意部分代码、重新包装或改写后分发且不注明原作者或出处。
 *		直接复制代码到自己的东西中发布还不注明来源的同学们请自重。因为使用开源的东西乃们也没有继续开源，所以我已经不公开原始的源代码了。
 *
 *		助人者天助之，黄牛倒票者退散！！！！
 *
 *
 *		PS：如果您热爱技术愿意共同学习进步，欢迎加入 后花园·技术交流 C1群：134546850，原始源代码可以在群中获取 (^.^)
 */
function compressFunc(){return!1}function initUIDisplay(){injectStyle()}function injectStyle(){var n=document.createElement("style");n.id="12306_ticket_helper";n.type="text/css";n.textContent="body{font-family:微软雅黑,'Microsoft YaHei';}.titlebar{font-weight:bold;} button:focus,input:focus,select:focus{outline:0;transition:all linear 0.2s;}input, select{font-family:consolas, verdana, arial;}.fish_running, .fish_clock, .fish_error, .fish_ok {line-height:20px;text-indent:18px;background-repeat:no-repeat;background-position:2px 50%;font-size:12px;}.fish_running{background-image:url(data:image/gif;base64,R0lGODlhEAAQALMPAHp6evf394qKiry8vJOTk83NzYKCgubm5t7e3qysrMXFxe7u7pubm7S0tKOjo////yH/C05FVFNDQVBFMi4wAwEAAAAh+QQJCAAPACwAAAAAEAAQAAAETPDJSau9NRDAgWxDYGmdZADCkQnlU7CCOA3oNgXsQG2FRhUAAoWDIU6MGeSDR0m4ghRa7JjIUXCogqQzpRxYhi2HILsOGuJxGcNuTyIAIfkECQgADwAsAAAAABAAEAAABGLwSXmMmjhLAQjSWDAYQHmAz8GVQPIESxZwggIYS0AIATYAvAdh8OIQJwRAQbJkdjAlUCA6KfU0VEmyGWgWnpNfcEAoAo6SmWtBUtCuk9gjwQKeQAeWYQAHIZICKBoKBncTEQAh+QQJCAAPACwAAAAAEAAQAAAEWvDJORejGCtQsgwDAQAGGWSHMK7jgAWq0CGj0VEDIJxPnvAU0a13eAQKrsnI81gqAZ6AUzIonA7JRwFAyAQSgCQsjCmUAIhjDEhlrQTFV+lMGLApWwUzw1jsIwAh+QQJCAAPACwAAAAAEAAQAAAETvDJSau9L4QaBgEAMWgEQh0CqALCZ0pBKhRSkYLvM7Ab/OGThoE2+QExyAdiuexhVglKwdCgqKKTGGBgBc00Np7VcVsJDpVo5ydyJt/wCAAh+QQJCAAPACwAAAAAEAAQAAAEWvDJSau9OAwCABnBtQhdCQjHlQhFWJBCOKWPLAXk8KQIkCwWBcAgMDw4Q5CkgOwohCVCYTIwdAgPolVhWSQAiN1jcLLVQrQbrBV4EcySA8l0Alo0yA8cw+9TIgAh+QQFCAAPACwAAAAAEAAQAAAEWvDJSau9WA4AyAhWMChPwXHCQRUGYARgKQBCzJxAQgXzIC2KFkc1MREoHMTAhwQ0Y5oBgkMhAAqUw8mgWGho0EcCx5DwaAUQrGXATg6zE7bwCQ2sAGZmz7dEAAA7); color: green;}.fish_clock{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAG/SURBVHjapJM/S8NQFMVvpaVfoEKojWL9U3DLIqjoooJDu/sFmnQoiIujQz+Aix3a1FUQXIR2UFA6+WeRUhBprERroGTopg6lSeo7iY1pq4sNHPpy3+8c7n0v9XW7XRrl8SFAlmVvbYFpmynOJHzXKkwlphOmxx4oiiL5sbAsi1KpFOVyuWQwGMzEYjEuGo0Sx3E2qOu6oKqqoChKst1u7zO2wNifDrLZLNbJUCgkLy2vEM/zv7araRrd3lxTq9US2WshnU7TGDZM01zwBwKZxaVlCkd4MtmxQDXlyVbvHXtgwMIDrx3Q6XS2Z2bnufDEJJkWuWIt2/LWwICFxw0wDCM+PTPXB0K4IGiwDhYeeP3fHQjjXIQMq3/mev3J/l0fqIOFxxtAxi+fg/rsBOztSE7QVpwpQT2PN6Dy1mgIYX7KNZcvipQ5yA+Fosum1rA93jMo1R6q7oxX50Va20wMzd4TWHi8t3BSvb/T1bpz4qsbf5vBgIXHDWB3+vj58b5fPj9jc9fcex8U9sCAhcc7Au1mDgtN7VU8Oz7SL0un9PbyTBYzQVijhj0wYOFxP2VJkv71Z8rn807AKM+XAAMArp1CsEFrDIIAAAAASUVORK5CYII=); color: blue;}.fish_error{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAJFSURBVHjapJO/T1pRFMe/Dx7ypEXri4lUGUhsHF40hODSpQ61cTH+2HSoZaF1dHSxpU7+Ca04NE7dyuBiapcuLFokTdD4A01awNdBSkAf8ut5zhUoxq3e5OS+nPv5nnvuyfdJpmniPksSBd68aM1pFDMU4xS+ei5GsUHxmSLRJD9+hcx7rVqFZWwMtc3NIGy2Zam31yX19ABdXTdgNuszdd1nptNBlMtviQ0TC0ujg1LgGWNByelctQ4M4G8qhfN4HLmDA6HvpJzq9eJRXx+qlDPz+deUDrd9+i6KoFouazVg2erx4M/uLn5FItGLk5NX/qUliYO+I2o2C4vLBWaYZQ1rRYFyqTQDVXXl02mcb29HbXb7S+/CwjqKRSAaDXlHRqYwOoqdxUUww6zQNApUSqVxuaMDF8kk2hTlgxYIHMMwaHSxEB2/a4g7u7sjzDDLmn8dXF35ZJsNVWrzycTEOtxuYH//lpjWezqbZoZZ1rQ+AXyj3eEQO7a27oj9s7OhVkZoWjqIFXUdD1QVub29L3fEk5MhXF7y2RwzzLKmdQYb+UwGiqLwO6duiVdWxM2GrvfTfOaZYZY1TScmvE7NKsvf3B6PyzE8jB9ra6DJR2TTnBYXSNIcbfN021Mjl8Pv09OzaqXyXIvnE6LAT00RRlLa21cfk1kesgNpULBab5xITiUHokADzJDJioYhjDSUKNafUKlgaHAwXCCHJQ8Pz1JHRyhQm2RhEfzNOT5jhlnWNJ+w0y/918/kPzbrf+M91rUAAwCuQDz94e2kLwAAAABJRU5ErkJggg==); color: blue;}.fish_ok{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAHsSURBVHjapFNBSBtBFH2xgoqmKipEC6XkYqhUWXOxUAQhpyJ4Wgi0l0rNsdBbL/WgF2/eV8hNSBF68uhFkOrFhCAGS8mWgmYjG9lCKVGTuP1vsrvuIac68HZm/n/vz5/9fyKu6+IhI8IA5k4kbHsuSAsWBZpnKwh2BTlBySfGdTmcAX7kOJc5r5hfhyw7/86t21/EVVbgmjb6yPG4SqsyONtWGaz0Dk8aYzMf0R+b65ju3+oR7OImrp3vGdluJd646KKj1ZK0H0XXRqfeo390Emg6HUEfOeQqjQwVoNFAOvpkPjYw8kw2NRgfFtQchm8jh1xqggDNJhYHY3Jy41IhmXodrDvZyKWG2m4vA23gcR9wa6m7Jue1YO2PsI1casIB5GPBWM8ilZLyvFzu+BPNwyz29oDM5+W2JhSg8NsqaRSTMHycxfg4MDHRJlUqgCWHO/IvyRGu0gQB5D671Z+mlpiZFXEejjSInrw/OS4wjiWwNFx8ehZnRVNpwlXI/SrXqvbFOfS3TxWRAtNpwxfTRw651AQZSE1Lrfrd6mmhZky96IGejuJgX5rL9HpbrvBKbHbFxunJDa6F67e0X0YsLWHr6uouc/StXi3m/yCRkNTjbXBNG33kkEtN8Jh2Pv3fY9I3vLfwkPFPgAEApRUigcIVl3AAAAAASUVORK5CYII=); color: purple;}.outerbox{font-family:'Microsoft Yahei','Apple LiGothic Medium',Arial,Helvetica,Sans-serif;color:#4c4c4c;margin: 10px auto;}.box{border:1px solid #c6c6c6;}.box .title{color:#444; font-weight:bold; padding:5px;line-height:23px;background-color:#dfdfdf;background:linear-gradient(#DDD 0%, #E7E7E7 100%); position: relative;text-shadow:1px 1px 3px #E7E7E7;}.box .title a{}.box .time-comp{position:absolute;margin:2px;right:2px;top:2px;padding:1px 12px;border-radius:12px;border:1px solid #ccc;color:#888;}.box .content{padding:5px;background-color:#fff}.box table{border-collapse:collapse;width:98%}.box table td{padding:5px;}.box table .tfooter{text-align:center;height:24px;background:-webkit-linear-gradient(#ffffff,#fafafa 90%);background:-moz-linear-gradient(#ffffff,#fafafa 90%);color:#707070;}.box table .tfooter a{color:#707070;}.box input[type=button],.fish_button,.fish_button_highlight{font-size:12px;font-family:'Microsoft Yahei','Apple LiGothic Medium',Arial,Helvetica,Sans-serif;padding:1px 6px;letter-spacing:1px;border-radius:3px;cursor:pointer;}.box .name,.box .caption,.box .caption td{font-weight:bold;-webkit-transition:all linear 0.2s;-moz-transition:all linear 0.2s;background:-webkit-linear-gradient(#fafafa,#f0f0f0 90%);background:-moz-linear-gradient(#fafafa,#f0f0f0 90%);background-color:#fafafa;}.lineButton{font-family:'Microsoft Yahei','Apple LiGothic Medium',Arial,Helvetica,Sans-serif;line-height:16px;margin-right:6px;padding:2px 4px;color:#4c4c4c;backround:#f5f5f5;background:-webkit-linear-gradient(#fff,#f0f0f0);background:-moz-linear-gradient(#fff,#f0f0f0);border:1px solid #c8c8c8;border-radius:3px;box-shadow:inset 0 1px 3px rgba(255,255,255,0.2),0 0 3px rgba(0,0,0,0.2);text-shadow:.0em .1em .1em rgba(255,255,255,0.8);-webkit-transition:all linear 0.2s;-moz-transition:all linear 0.2s;cursor:pointer;}.lineButton:hover{background:#f0f0f0;text-shadow:.0em .1em .1em #fff;-webkit-transition:all linear 0.1s;-moz-transition:all linear 0.1s;}.lineButton:active{background:#f2f2f2;background:-webkit-gradient(linear,left bottom,left top,color-stop(0%,#f2f2f2),color-stop(90%,#f2f2f2));background:-moz-linear-gradient(center bottom,#f2f2f2 0%,#f2f2f2 100%);box-shadow:inset 0px 1px 3px #cccccc,0px 0px 0px #0968bb;border-color:#d6d6d6;border-top-color:#d0d0d0;border-left-color:#d0d0d0;border-right-color:#e2e2e2;border-bottom-color:#e2e2e2;}.lineButton:disabled {background:none #dfdfdf; text-shadow:none; box-shadow:none; color:#bebebe;}.fishTab{border:5px solid #C4C9DF;font-size:12px;font-family:'Microsoft Yahei','Apple LiGothic Medium',Arial,Helvetica,Sans-serif;}.fishTab .innerTab{border-width:1px;border-style:solid;border-color:#7381AC;background-color:#fff}.fishTab .tabNav{font-weight:bold;color:#F5F1F8;background-color:#777FA7;line-height:25px;overflow:hidden;margin:0px;padding:0px}.fishTab .tabNav li{float:left;list-style:none;cursor:pointer;padding-left:20px;padding-right:20px}.fishTab .tabNav li:hover{background-color:#B1BBE2}.fishTab .tabNav li.current{background-color:#fff;color:#000}.fishTab .tabContent{padding:5px;display:none}.fishTab .tabContent p{margin:10px 0px 10px 0px}.fishTab div.current{display:block}.fishTab div.control{text-align:center;line-height:25px;background-color:#EAECF4}.fishTab input[type=button]{padding:2px 5px;margin:4px;}.hide{display:none}.fish_area {font-weight:bold;background: -moz-linear-gradient(#F0EEEE 0%, #ECECEC 50%, #DFDFDF 50%, #FFF 100%);background: -webkit-linear-gradient(#F0EEEE 0%, #ECECEC 50%, #DFDFDF 50%, #FFF 100%); color: #555; text-shadow: 1px 1px 2px #ddd;}.fish_area td {font-weight:bold; text-align:center;}.fish_sep td{border-top:1px solid #d0d0d0;}.fish_button{color:#fff;line-height:normal;margin:0 5px;background:#0f7edb;background:-webkit-linear-gradient(#0c96f8,#1960b7);background:-moz-linear-gradient(#0c96f8,#1960b7);border:1px solid #186fb7;box-shadow:inset 0 1px 3px rgba(255,255,255,0.2),0 0 3px rgba(0,0,0,0.3);text-shadow:.0em .1em .1em rgba(50,50,50,0.8);-webkit-transition:all linear 0.2s;-moz-transition:all linear 0.2s;}.fish_button:hover{background:#099bff;background:-webkit-gradient(linear,left bottom,left top,color-stop(0%,#077ccc),color-stop(90%,#0abaff));background:-moz-linear-gradient(center bottom,#077ccc 0%,#0abaff 100%);border-color:#088be5;-webkit-transition:all linear 0.1s;-moz-transition:all linear 0.1s;}.fish_button:active{background:#0885e7;background:-webkit-gradient(linear,left bottom,left top,color-stop(0%,#066ab8),color-stop(90%,#099fff));background:-moz-linear-gradient(center bottom,#066ab8 0%,#099fff 100%);border-color:#0777cf;box-shadow:inset 0px 1px 2px #0770c3,0px 0px 0px #000;border-top-color:#0775ca;border-left-color:#0775ca;border-right-color:#087edb;border-bottom-color:#087edb;}.fish_button_highlight{border:1px solid green;box-shadow:inset 0 1px 3px rgba(255,255,255,0.2),0 0 3px rgba(0,0,0,0.3);text-shadow:.0em .1em .1em rgba(50,50,50,0.8);-webkit-transition:all linear 0.2s;-moz-transition:all linear 0.2s;color:#fff;line-height:normal;margin:0 5px;background:-webkit-linear-gradient(#228F38,#5BC05B);background:-moz-linear-gradient(#228F38,#5BC05B);background:linear-gradient(#228F38,#5BC05B);border-color:green;}.fish_button_highlight:hover{background:-webkit-linear-gradient(#2FBB4C,#70E270);background:-moz-linear-gradient(#2FBB4C,#70E270);background:linear-gradient(#2FBB4C,#70E270);}.fish_button:disabled{background:-webkit-gradient(linear,left bottom,left top,color-stop(0%,#B7C0C9),color-stop(90%,#777777));background:-moz-gradient(linear,left bottom,left top,color-stop(0%,#B7C0C9),color-stop(90%,#777777));color:#ccc;border-color:#777;}tr.steps td{background-color:#E8B7C2!important;-webkit-transition:all linear 0.1s;-moz-transition:all linear 0.1s}tr.stepsok td{background-color:#BDE5BD!important;-webkit-transition:all linear 0.1s;-moz-transition:all linear 0.1s}tr.steps span.indicator{display:inline-block!important}tr.stepsok span.indicator{display:inline-block!important}.highlightrow td{background-color:#D0C0ED!important;color:red}#randCodeTxt{font-weight:bold;font-size:18px;text-align:center;padding:3px 10px 3px 10px;font-family:verdana!important;text-transform:uppercase}tr.append_row{font-family:'Microsoft Yahei','Apple LiGothic Medium',Arial,Helvetica,Sans-serif;}div.gridbox_light .odd_light,div.gridbox_light .ev_light{background:-webkit-linear-gradient(#fff,#f6f6f6);background:-moz-linear-gradient(#fff,#f6f6f6);text-shadow:.0em .1em .1em rgba(255,255,255,0.8);}.validCell{ background:-webkit-linear-gradient(#e0ebff, #c7d9ff)!important; background:-moz-linear-gradient(#e0ebff, #c7d9ff)!important; color:green; }.validCell:hover{ background:-webkit-linear-gradient(#A9C6FC, #84ACFF)!important; background:-moz-linear-gradient(#A9C6FC, #84ACFF)!important; color:green; }.validRow{background:-webkit-linear-gradient(#ffe0e5, #ffc7d0)!important;background:-moz-linear-gradient(#ffe0e5, #ffc7d0)!important;color:#700012;}.validRow:hover{background:-webkit-linear-gradient(#EBC7CD, #DFA1AB)!important;background:-moz-linear-gradient(#EBC7CD, #DFA1AB)!important;cursor:pointer;}.unValidRow{opacity:0.8;} .unValidRow:hover td {background:#eee;!important} .unValidRow td:hover {background:#ddd;!important}.unValidCell{opacity:0.8;}.btn130_2 {text-shadow:none;}.warning{color:red;}input[type=checkbox].current{color:red;font-weight:bold;}span.leftTicketStatusSpan{color:green; font-weight:bold;}.gridtb { width:100%!important; }.gridtb th {text-align:center;padding: 5px; border-right: 1px solid #ccc; font-weight:bold;-webkit-transition:all linear 0.2s;-moz-transition:all linear 0.2s;background:-webkit-linear-gradient(#fafafa,#f0f0f0 90%);background:-moz-linear-gradient(#fafafa,#f0f0f0 90%);background-color:#fafafa;}.gridtb .last {border-right:none;}.gridtb td {border-right: 1px dotted #ccc; border-bottom: 1px solid #ccc; padding:5px; text-align: center;}.gridtb div {text-align:center;}#footRow {border-bottom:none; text-align: left;}.gridtb a{display:block; text-align:center;}.fish_opt {margin:0;overflow:hidden;box-shadow:1px 1px 3px #f7f7f7;border:1px solid #ddd;background-color:#fff;}.fish_opt li{width:175px; float:left; line-height:30px;padding-left:5px;padding-right:5px;}.fishDialog {border-radius: 10px;  box-shadow: #7E9BCB 5px 5px 10px; width: 500px; display: none;}.fishDialogTitle { font-size:120%; line-height: 30px; text-align: center;font-weight: bold;color: #fff;background: -webkit-linear-gradient(#7292C6, #40649F);background: -moz-linear-gradient(#7292C6, #40649F); border-radius: 6px 6px 0 0;}.fishDialogContent { background-color: #fff; padding: 15px; }.fishDialogControls { padding: 2px;background-color: #f0f0f0;text-align: right; border-radius: 0 0 6px 6px; }.fishDialogMask{position:fixed;left:0;top:0;background-color:#4e7896;opacity:.5;z-index:9999;width:100%;display:block;-moz-background-size:40px 40px;-o-background-size:40px 40px;-webkit-background-size:40px 40px;background-size:40px 40px;background-image:-webkit-linear-gradient(45deg,rgba(255,255,255,.1) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.1) 50%,rgba(255,255,255,.1) 75%,transparent 75%,transparent);background-image:-moz-linear-gradient(45deg,rgba(255,255,255,.1) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.1) 50%,rgba(255,255,255,.1) 75%,transparent 75%,transparent);}.fishTimeRangePicker {position:relative;} .fishTimeRangePicker .fishTimePickerPopup {display:none;} .fishTimeRangePicker:hover .fishTimePickerPopup{display:block;}.fishTimeRangePicker a {display: block;text-align: center;border: 1px solid;font-size: 110%;font-family: 'comic sans ms','微软雅黑'}.fishTimePickerPopup {position: absolute;left: 0px;top: 26px;border: 1px solid gray;background: #E9E6E6;padding: 8px; width:160px;} .enter_rfont li {padding-left:0;} .flat_button{border: 1px solid #ddd;line-height: 24px;padding-left: 10px;padding-right: 10px;color: #666;background: #eee; transition: all linear 0.1s;} .flat_button:hover {cursor:pointer;color:#fff;background-color:#a8a8a8;} .flat_button:disabled {background-color:#fff;color:#ddd; text-decoration:line-through; cursor:not-allowed;} .flat_button:disabled:hover {background-color:#fff;color:#ddd; cursor:not-allowed;}.flatbutton{padding:2px 4px;border:1px solid #ddd;background-color:#f9f9f9;text-decoration:none;border-radius:3px;margin-right:1px;transition:all linear 0.2s;}.flatbutton:hover{text-decoration:none;background:#ddd;}.cx_form { overflow:visible!important; } ";document.head.appendChild(n)}function injectDom(){var n=[],i,r,t,u;if(n.push('<div id="fishOption" style="width: 600px; display:none; box-shadow: 7px 7px 10px rgb(126, 146, 188);">'),n.push('<div class="innerTab">'),n.push('<ul class="tabNav" default="tabVersion">'),n.push('<li tab="tabLogin">常规设置<\/li>'),n.push('<li tab="tabReg">注册<\/li>'),n.push('<li tab="tabFaq">常见问题<\/li>'),n.push('<li tab="tabVersion">版本信息<\/li>'),n.push('<li tab="tabLoginIE">登录到IE<\/li>'),n.push("<\/ul>"),n.push('<div class="tabContent tabLogin">'),n.push('<table style="width:100%;">'),n.push('<colgroup><col style="width:10%;" /><col style="width:23%;" /><col style="width:10%;" /><col style="width:23%;" /><col style="width:10%;" /><col style="width:24%;" /><\/colgroup><tr>'),n.push("<td>重试时间 "),n.push("<\/td>"),n.push('<td><input type="text" name="login.retryLimit" size="6" value="2000" />'),n.push("(ms)<\/td>"),n.push("<td>随机等待"),n.push("<\/td>"),n.push("<td><input style='width:40px;text-align:center;' title='刷新的时候有个固定的间隔，在此基础上叠加一个0到<本值>的随机时间。' type='number' min='0' value='3' size='4' id='refereshInterval' name='refereshInterval' style='text-align:center;' />秒<\/td>"),n.push("<td colspan=''>刷新间隔<\/td><td><input style='width:40px;text-align:center;' title='每次刷新后，休息时间中的固定部分。' type='number' min='5' value='5' size='4' id='baseAutoRefreshDelay' name='baseAutoRefreshDelay' style='text-align:center;' />秒<\/td><\/tr>"),n.push("<td colspan=''>整点延迟<\/td><td><input style='width:40px;text-align:center;' title='等待放票时，等到放票时间点后延迟查票时间。' type='number' min='0' value='3' size='4' id='delayAfterHourStop' name='delayAfterHourStop' style='text-align:center;' />秒<\/td><\/tr>"),n.push("<tr>"),n.push("<\/tr>"),n.push("<tr><td>自动展开<\/td><td colspan='3'><label><input type='checkbox' name='query.autoexpand' value='1' />查询的车次结果尽可能显示为最高<\/label><\/td><\/tr>"),n.push("<\/table>"),n.push("<\/div>"),n.push('<div class="tabContent tabReg" style="text-indent: 20px">'),n.push("<p>为了阻止地球人他喵地拿作者无偿奉献的助手去卖钱钱，请注册唷。<strong>完全免费申请<\/strong>。<\/p>"),n.push('<p style="color: red;"> <strong style="font-size:16px;">亲，本助手完全免费。。。<\/strong>任何在第三方网站上出售的软件全是山寨的……看到的时候请亲务必退款退货扔差评。。。<\/p>'),n.push('<p style="color:purple;"> 回家是一个单纯而简单的心愿，希望我们不会变得太复杂……<\/p>'),n.push("<p>任何版本之间，功能上没有任何区别，So……不要问作者万一资助的话会有神马新功能，木有的说…… (=￣ω￣=) <\/p>"),n.push('<p class="registered" style="display:none;">很高兴认识你，<strong>fishcn@foxmail.com<\/strong>，谢谢你的出现~~~~已注册版本：<strong>正式版<\/strong>【<a href="javascript:;" id="unReg">重新注册<\/a>】<\/p>'),n.push('<table class="regTable" style="display:none;width:98%;">'),n.push("<tr>"),n.push('<td>请粘贴注册码 【<a href="http://www.fishlee.net/Apps/Cn12306/GetNormalRegKey?v=1" target="_blank" style="color:blue;font-weight:bold;text-decoration:underline;">戳我直接申请注册码啊！为什么你们舍不得戳我啊 ╮(╯▽╰)╭<\/a>】<\/td>'),n.push("<\/tr><tr>"),n.push('<td style="text-align:center;"><textarea id="regContent" style="width:98%; height:50px;"><\/textarea><\/td>'),n.push("<\/tr><tr>"),n.push('<td><input type="button" id="regButton" value="注册" /><\/td>'),n.push("<\/tr>"),n.push("<\/table>"),n.push("<\/div>"),n.push('<div class="tabContent tabVersion" style="text-indent: 20px">'),n.push('<h4 style="font-size:18px; font-weight:bold; margin: 0px; line-height: 26px; border-bottom: 1px dotted #ccc;">12306 订票助手 '+utility.spec+" <small>ver "+window.helperVersion+"<\/small><\/h4>"),n.push("<p> 12306 订票助手是一款用于订票的助手软件，"+(utility.isLieBaoEdition?"您正在使用的是为<strong>猎豹浏览器<\/strong>特别定制的版本":"嗯……看到这里相信你已经知道它支持神马浏览器了")+" =。=<strong>完全免费，无需付费使用，仅接受捐助。<\/strong> <\/p>"),n.push('<p style="color: red;"> <strong style="font-size:16px;">亲，本助手完全免费。。。<\/strong>任何在第三方网站上出售的软件全是山寨的……看到的时候请亲务必退款退货扔差评。。。<\/p>'),n.push('<p style="color:purple;"> 回家是一个单纯而简单的心愿，希望我们不会变得太复杂……<\/p>'),n.push('<p> 有很多朋友资助作者，小的感激涕零 ≥ω≤。<a href="http://www.fishlee.net/soft/44/donate.html" target="_blank">戳这里了解捐助详情<\/a>。 <\/p>'),n.push('<p style="font-weight:bold;">当前版本更新内容<\/p>'),n.push("<ol >"),$.each(utility.getPref("updates").split("\t"),function(t,i){n.push("<li style='padding:0 0 6px 20px;list-style:none;'>"+i+"<\/li>")}),n.push("<\/ol>"),n.push("<\/div>"),n.push('<div class="tabContent tabFaq">'),n.push("<table>"),n.push("<tr>"),n.push('<td colspan="4"> 你在订票过程中可能……会遇到各种问题，由于介个12306网站本身呢……木有没有任何介绍 ╮(╯▽╰)╭ ，所以老衲整理了相关问题，供客官参考。如果还有不明白的问题，加群讨论呗  (=￣ω￣=) 。 <br /><br />'),n.push('1.放票非正点也，So在将近放票的时候，务必保持刷新状态哈，而且……当整点没有放票时，不要放弃继续刷新喔；<br />2.动车都是11点放票撒，切记切记；<br />3.第一波放票悲催地木有订到时，请耐心等待，因为现在放票有N多节点，随时会有票出来，晚很久才放票也正常，铁老大经常秀下限嘀；<br />4.如果您的车票很难买，请尽量发动你的七大姑八大姨神马的一堆朋友过来集体帮忙，同时建议用多个浏览器刷票，因为缓存的关系不同的浏览器出现票的时间可能不同；<br />好了，废话说完鸟，祝大家买票顺利，贫僧只希望不会帮倒忙就好了 ╮(╯▽╰)╭<br />如果您还有问题的话，<a href="http://www.fishlee.net/soft/44/tour.html" target="_blank">建议点击这里查看教程~~~~<\/a>'),n.push("<\/td><\/tr>"),n.push('<tr style="display:none;">'),n.push('<td><a href="http://www.fishlee.net/soft/44/12306faq.html" target="_blank">订票常见问题<\/a><\/td>'),n.push('<td><a href="http://www.fishlee.net/soft/44/faq.html" target="_blank">助手运行常见问题<\/a><\/td>'),n.push("<\/tr>"),n.push("<\/table>"),n.push("<\/div>"),n.push('<div class="tabLoginIE tabContent"><div><strong>先在IE中打开 https://dynamic.12306.cn/otsweb，<\/strong>再将以下代码复制到IE浏览器的地址栏。确认地址栏最前面有“javascript:”字样，没有请手动加上（IE10会自动删除这样的代码），然后敲回车，等待页面刷新后，即可自动登录。<\/div><textarea id="LoginIECode" style="width:100%;height:200px;"><\/textarea><\/div>'),n.push('<div class="control">'),n.push('<input type="button" class=" fish_button close_button" value="关闭" />'),n.push("<\/div>"),n.push("<\/div>"),n.push("<\/div>"),$("body").append(n.join("")),i=$("#fishOption"),$("#regButton").click(function(){var t=$.trim($("#regContent").val()),n=utility.verifySn(!1,"",t);if(n.result!=0)alert("很抱歉, 注册失败. 代码 "+n.result+", "+n.msg);else{utility.setSnInfo("",t);alert("注册成功, 请刷新浏览器。\n注册给 - "+n.name+" , 注册类型 - "+n.typeDesc.replace(/<[^>]*>/gi,""));try{utility.getTopWindow().location.reload()}catch(i){alert("权限不足无法刷新页面， 请手动刷新当前页！")}}}),$("#unReg, a.reSignHelper").live("click",function(){if(utility.regInfo.partner!=1&&utility.regInfo.result==0&&utility.regInfo.type!="DEMO"){if(!confirm("确定要重新注册吗?"))return;utility.setSnInfo("","");utility.getTopWindow().location.reload()}else utility.getTopWindow().utility.showOptionDialog("tabReg")}),utility.configTab=utility.fishTab(i),i.find("input[name]").each(function(){var n=$(this),i=n.attr("name"),t=window.localStorage.getItem(i);t&&(n.attr("type")=="checkbox"?n.attr("checked",t=="1"):n.val(t))}).change(function(){var n=$(this),t=n.attr("name");n.attr("type")=="checkbox"?window.localStorage.setItem(t,n[0].checked?1:0):window.localStorage.setItem(t,n.val())}),$("#configLink, .configLink").live("click",function(){var n=$(this),t=n.attr("tab");utility.getTopWindow().utility.showLoginIE();utility.getTopWindow().utility.showOptionDialog(t||"")}),utility.getPref("helperVersion")!=window.helperVersion){utility.getPref("helperVersion")?window.submitReport(44):window.submitReport(43);utility.clearFeatrueDisabled(),function(n){for(var t in n)localStorage.removeItem(n[t])}(["_timeFilterFrom1","_timeFilterFrom2","_timeFilterTo1","_timeFilterTo2"]);r=["ontimequeuecount"];utility.isAdvancedSupport()||r.push("ontimeleftticket");utility.setPref("disabled",r.join("|"));utility.disabledFeaturesCache=null,function(){var t=new Date,n;for(t.setTime(t.getTime()-1e3),n=0;n<arguments.length;n++)document.cookie=arguments[n]+"=; path=/; domain=.12306.cn; expires="+t.toGMTString()}("helper.regUser","helper.regSn");utility.setPref("pas","");(utility.getAudioUrl().indexOf("github")!=-1||utility.getAudioUrl().indexOf("resbak.")!=-1)&&utility.resetAudioUrl();utility.setPref("helperVersion",window.helperVersion);try{parent==self&&utility.showOptionDialog("tabVersion")}catch(f){utility.showOptionDialog("tabVersion")}}$(".resetFuncFlag").live("click",function(){var t=this.dataset.function,n=$.inArray(t,utility.disabledFeatures());n!=-1&&(utility.disabledFeaturesCache.splice(n,1),utility.disableFeature(),utility.getTopWindow().location.reload())});t=utility.verifySn(!0);t.result==0&&t.type!="DEMO"&&(u=i.find(".registered").show().find("strong"),u.eq(0).html(t.name),u.eq(1).html(t.typeDesc));(t.partner==1||t.result!=0||t.type=="DEMO")&&(i.find(".regTable").show(),t.result!=0&&(location.pathname=="/otsweb/"||location.pathname=="/otsweb/main.jsp")&&(alert("为了阻止地球人趁火打劫然后拿着老衲免费奉献的东东去卖钱，贫僧斗胆麻烦客官……啊不，施主注册下下，一下子就好了啦！"),window.open("http://www.fishlee.net/Apps/Cn12306/GetNormalRegKey"),utility.showOptionDialog("tabReg")));utility.regInfo=t;$(".dismiss_button").live("click",function(){var n=$(this),t="msg_"+n.attr("data-target");confirm("确定要隐藏此提示咩？如果隐藏，直到下次版本升级前，都是不会再显示的喔。")&&(utility.setPref(t,window.helperVersion),$("#"+n.attr("data-target")).hide())})}function finishUi(){$(".dismiss_button").each(function(){var n=$(this),t="msg_"+n.attr("data-target");utility.getPref(t)==window.helperVersion&&$("#"+n.attr("data-target")).hide()})}function unsafeInvoke(n){var t=document.createElement("script");t.type="text/javascript";t.textContent=buildCallback(n);document.head.appendChild(t)}function buildCallback(n){var i="",t;return utility_emabed||(i+="window.helperVersion='"+version+"'; window.compVersion='"+compVersion+"'; if(typeof(window.utility)!='undefined' &&(!utility.isSogou&&!utility.isMaxthon)){ alert('喵……您似乎同时运行了两只助手! 请转到『附加组件管理『（Firefox）或『扩展管理』（Chrome）中卸载老版本的助手。。。');}; \r\nwindow.utility="+buildObjectJavascriptCode(utility)+"; window.utility.init();\r\n",utility_emabed=!0),typeof n=="function"&&(t=n.name),t||(t=Math.random()+""),i+("("+buildObjectJavascriptCode(n)+")();"+(isDebug?"\r\n//@ sourceURL=http://www.fishlee.net/soft/44/scripts/"+t+".js":""))}function buildObjectJavascriptCode(n){var u,t,i,r,f;if(n==null)return"null";if(typeof n=="undefined")return"undefined";if(u=typeof n,u=="string")return'"'+n.replace(/(\r|\n|\\)/gi,function(n,t){switch(t){case"\r":return"\\r";case"\n":return"\\n";case"\\":return"\\\\"}})+'"';if(u!="object")return n+"";t=[];for(i in n)r=n[i],f=typeof r,f=="object"||f=="string"?t.push(i+":"+buildObjectJavascriptCode(r)):t.push(i+":"+r);return"{"+t.join(",")+"}"}function initialzeAndStartup(){initReport();utility.setPref("updates",updates.join("\t"));checkDefaultOption();initUIDisplay();unsafeInvoke(injectDom);entryPoint();checkUpdate()}function entryPoint(){var n=window.location,t=n.pathname,u,r,i;if(utility.regInfo=utility.verifySn(!0),utility.regInfo.result!=0,unsafeInvoke(autoReloadIfError),(t=="/otsweb/loginAction.do"&&n.search!="?method=initForMy12306"||t=="/otsweb/login.jsp")&&(unsafeInvoke(initLogin),mapTabIndex(["UserName","password","randCode","subLink"])),utility.regInfo.bindAcc&&localStorage.getItem("_sessionuser")&&utility.regInfo.bindAcc.length>0&&utility.regInfo.bindAcc[0]&&utility.regInfo.bindAcc[0]!="*"){for(u=localStorage.getItem("_sessionuser"),r=!1,i=0;i<utility.regInfo.bindAcc.length;i++)if(utility.regInfo.bindAcc[i]==u){r=!0;break}if(!r)return}t=="/otsweb/order/querySingleAction.do"&&(n.search=="?method=init"&&document.getElementById("submitQuery")&&injectQueryScripts(),n.search=="?method=submutOrderRequest"&&unsafeInvoke(initSubmitOrderQuest));t=="/otsweb/order/orderAction.do"&&n.search.indexOf("method=cancelMyOrderNotComplete")!=-1&&document.getElementById("submitQuery")&&injectQueryScripts();t=="/otsweb/order/payConfirmOnlineSingleAction.do"&&n.search.indexOf("method=cancelOrder")!=-1&&document.getElementById("submitQuery")&&injectQueryScripts();t=="/otsweb/order/myOrderAction.do"&&(n.search.indexOf("method=resign")!=-1&&document.getElementById("submitQuery")&&injectQueryScripts(),n.search.indexOf("queryMyOrder")!=-1&&unsafeInvoke(queryMyOrder));(t=="/otsweb/order/confirmPassengerAction.do"||t=="/otsweb/order/confirmPassengerResignAction.do")&&(n.search=="?method=init"&&(unsafeInvoke(initAutoCommitOrder),unsafeInvoke(autoCommitOrderInSandbox)),n.search.indexOf("?method=payOrder")!=-1&&(unsafeInvoke(initPagePayOrder),unsafeInvoke(utility.enableLoginIE)));t=="/otsweb/order/myOrderAction.do"&&(n.search.indexOf("?method=laterEpay")!=-1||n.search.indexOf("?method=queryMyOrderNotComplete")!=-1)&&(unsafeInvoke(initNotCompleteOrderPage),unsafeInvoke(initPayOrder),unsafeInvoke(utility.enableLoginIE));t=="/otsweb/passengerAction.do"&&n.search.indexOf("?method=initUsualPassenger")!=-1;t=="/otsweb/main.jsp"||t=="/otsweb/"?(unsafeInvoke(injectMainPageFunction),document.body.addEventListener("notify",function(n){var i=n.detail,t=i.msg,r=i.title,u=i.timeout,f;if(typeof GM_notification!="undefined"){GM_notification(t);return}if(typeof chrome!="undefined"&&typeof chrome.extension!="undefined"){chrome.extension.sendRequest({"function":"notify",message:t,timeout:u,title:r});return}if(typeof sogouExplorer!="undefined"&&typeof sogouExplorer.extension!="undefined"){sogouExplorer.extension.sendRequest({"function":"notify",message:t,timeout:u,title:r});return}f=webkitNotifications.createNotification("http://www.12306.cn/mormhweb/images/favicon.ico",r||"订票助手",t);setTimeout(function(){f.close()},u||5e3);f.show()})):(console.log("[12306订票助手][INFO] 初始化框架高度自动调整"),unsafeInvoke(function(){var t=$("div.conWrap"),i,n;t.length==1&&(i=parent.$("#main"),n=0,setInterval(function(){var r=t.height();r!=n&&(n=r,i.height(n+10),parent.window.setHeight(parent.window))},500))}));unsafeInvoke(finishUi)}function injectQueryScripts(){unsafeInvoke(initTicketQuery);unsafeInvoke(initAutoPreSubmitOrder);unsafeInvoke(initAdvancedTicketQuery);unsafeInvoke(initDirectSubmitOrder);unsafeInvoke(dgFilterQuery)}function queryMyOrder(){$(".table_clist").each(function(){var n=$(this);n.find("tr:gt(0):not(.table_plgq)").each(function(){var i=$(this),n=i.find("td:eq(3)"),r=n.html(),t=/<!--\s*(.+?)-->/i.exec(r);t[1]&&n.append(t[1])})})}function initNotCompleteOrderPage(){if(OrderQueueWaitTime&&OrderQueueWaitTime.prototype.getWaitTime){var n=/url\s*:\s*['"]([^'"]+)['"]/i.exec(OrderQueueWaitTime.prototype.getWaitTime+"")[1];n&&function(){function i(){var r=t.shift();t.push(r);utility.get(n,{tourFlag:r},"json",function(n){var t=$("#status_"+r);if(n.waitTime==0||n.waitTime==-1){t.css({color:"green"}).html("订票成功！");utility.notify("订票成功！请尽快付款！");parent.playAudio();self.location.reload();return}if(n.waitTime==-2){utility.notify("出票失败！请重新订票！"+n.msg);parent.playFailAudio();t.css({color:"red"}).html("出票失败！"+n.msg);return}if(n.waitTime==-3){utility.notify("订单已经被取消！");parent.playFailAudio();t.css({color:"red"}).html("订单已经被取消！！");return}n.waitTime==-4&&(utility.notify("正在处理中...."),t.css({color:"blue"}).html("正在处理中...."));n.waitTime>0?t.css({color:"red"}).html("等待开奖中<br />排队数【"+(n.waitCount||"未知")+"】<br />预计时间【"+utility.getSecondInfo(n.waitTime)+"】<br />不过这时间不<br />怎么靠谱 ╮(╯▽╰)╭"):t.css({color:"red"}).html("奇怪的状态码 ["+n.waitTime+"]....");setTimeout(i,2e3)},function(){utility.notify("查询状态错误，正在刷新页面！");self.location.reload()})}var r=$("input[name=cache_tour_flag]"),t=$.map(r,function(n){return n.value});$.each(t,function(){$("#showTime_"+this).hide().after("<span id='status_"+this+"'>正在查询...<\/span>")});t.length>0&&i()}()}}function initSubmitOrderQuest(){$("div.error_text").length>0&&parent.window.resubmitForm()}function initPagePayOrder(){new Audio(utility.getAudioUrl()).play()}function autoReloadIfError(){$.trim($("h1:first").text())=="错误"&&($("h1:first").css({color:"red","font-size":"18px"}).html("&gt;_&lt; 啊吖!，敢踹我出门啦。。。2秒后我一定会回来的 ╮(╯▽╰)╭"),setTimeout(function(){self.location.reload()},2e3))}function injectMainPageFunction(){var n=$("#main")[0];n.onload=function(){var t=null;try{t=n.contentWindow.location+""}catch(i){}t&&t!="http://www.12306.cn/mormhweb/logFiles/error.html"||resubmitForm()};window.resubmitForm=function(){var n=$("#orderForm");n.length!=0&&n.attr("success")=="0"&&(utility.notify("页面出错了！正在重新预定！"),setTimeout(function(){document.getElementById("orderForm").submit()},3e3))};window.playAudio=function(){new Audio(utility.getAudioUrl()).play()};window.playFailAudio=function(){utility.playFailAudio()}}function initAutoCommitOrder(){function t(t){n(!1,"错误 - "+t);k(t);$("div.tj_btn button, div.tj_btn input").each(function(){this.disabled=!1;$(this).removeClass().addClass("long_button_u")});$("#btnCancelAuto").hide();f=!1}function e(){if(window.isSafeMobeBlocked){n(!0,"正在等安全期再上……╮(╯▽╰)╭");return}if(l[0].blur(),$(document).trigger("stopcheckcount"),!window.submit_form_check||!submit_form_check("confirmPassenger")){n(!1,"您的表单没有填写完整!");t("请填写完整表单");return}if(h++,n(!0,"第 "+h+" 次试着买彩票"),i){t("已取消自动提交");i=0;return}$("#btnCancelAuto").show().removeClass().addClass("long_button_u")[0].disabled=!1;i=0;p=!1;$("#confirmPassenger").ajaxSubmit({url:d+$("#rand").val(),type:"POST",data:{tFlag:c},dataType:"json",timeout:1e4,success:function(i){"Y"!=i.errMsg||"N"==i.checkHuimd||"N"==i.check608?(n(!1,i.msg||i.errMsg),t(i.msg||i.errMsg),r()):tt()},error:function(){n(!1,"当前请求发生错误");utility.delayInvoke(null,e,1e3)}})}function tt(){var i={train_date:$("#start_date").val(),train_no:$("#train_no").val(),station:$("#station_train_code").val(),seat:$("#passenger_1_seat").val(),from:$("#from_station_telecode").val(),to:$("#to_station_telecode").val(),ticket:$("#left_ticket").val()};utility.get(g,i,"json",function(i){if(i.op_2){var u="系统说人多，不许买彩票了，看起来没办法了……重新输入验证码试试 (据说人数="+i.count+")";n(!0,u);t(u);r();return}setTimeout(ut,1e3)},function(){utility.delayInvoke(null,tt,2e3)})}function ut(){jQuery.ajax({url:v,data:$("#confirmPassenger").serialize(),type:"POST",timeout:1e4,dataType:"json",success:function(i){console.log(i);var u=i.errMsg;if(u!="Y"){if(u.indexOf("包含未付款订单")!=-1){alert("您有未支付订单! 等啥呢, 赶紧点确定支付去.");window.location.replace("/otsweb/order/myOrderAction.do?method=queryMyOrderNotComplete&leftmenu=Y");return}if(u.indexOf("重复提交")!=-1){t("重复提交错误，已刷新TOKEN，请重新输入验证码提交");s();r();return}if(u.indexOf("后台处理异常")!=-1||u.indexOf("非法请求")!=-1){o?(utility.notify("后台处理异常，已自动重新提交表单，请填写验证码并提交！"),o.submit()):t("后台处理异常，请返回查询页重新预定！");return}if(u.indexOf("包含排队中")!=-1){console.log("[12306订票助手]惊现排队中的订单， 进入轮询状态");w();return}n(!1,u);t(u);r()}else utility.notify("彩票已买下, 正在等待开奖，请及时注意开奖状态"),w()},error:function(){n(!1,"当前请求发生错误");utility.delayInvoke(null,e,3e3)}})}function s(){n(!0,"正在刷新TOKEN....");utility.get(self.location+"",null,"text",function(t){if(/TOKEN"\s*value="([a-f\d]+)"/i.test(t)){var i=RegExp.$1;n(!1,"已获得TOKEN - "+i);console.log("[12306订票助手]已刷新TOKEN="+i);$("input[name=org.apache.struts.taglib.html.TOKEN]").val(i)}else n(!1,"无法获得TOKEN，正在重试"),utility.delayInvoke("#countEle",s,1e3);rt.restart()},function(){utility.delayInvoke("#countEle",s,1e3)})}function w(){n(!0,"彩票提交成功，请等待开奖....");$.ajax({url:nt,data:{tourFlag:c},type:"GET",timeout:1e4,dataType:"json",success:function(i){var u;console.log(i);i.waitTime==-1||i.waitTime==0?(utility.notify("中奖咯!"),i.orderId?window.location.replace("/otsweb/order/confirmPassengerAction.do?method=payOrder&orderSequence_no="+i.orderId):window.location.replace("/otsweb/order/myOrderAction.do?method=queryMyOrderNotComplete&leftmenu=Y"),t("中奖咯！")):i.waitTime==-3?(u="很抱歉, 铁道部无齿地撤销了您的订单, 赶紧重新下!",utility.notify(u),n(!1,u),t(u),r()):i.waitTime==-2?(u="很抱歉, 铁道部说您占座失败 : "+i.msg+", 赶紧重新来过! 当长时间出现占座失败时, 建议您更改车次!",s(),utility.notify(u),n(!1,u),t(u),r()):i.waitTime<0?(u="很抱歉, 未知的状态信息 : waitTime="+i.waitTime+", 可能已成功，请验证未支付订单.",k(u),utility.notify(u),location.href="/otsweb/order/myOrderAction.do?method=queryMyOrderNotComplete&leftmenu=Y"):(u="彩票还要 "+utility.getSecondInfo(i.waitTime)+" 开奖， 请等待，不过你知道的，铁道部说的一直不怎么准。（排队人数="+(i.waitCount||"未知")+"）",i.waitTime>1800&&(u+="<span style='color:red; font-weight: bold;'>警告：排队时间大于30分钟，请不要放弃电话订票或用小号重新排队等其它方式继续订票！<\/span>"),k(u),i.waitTime>1800&&!p&&(p=!0,utility.notify("警告！排队时间大于30分钟，成功率较低，请尽快电话订票或用小号重新排队！")),utility.delayInvoke("#countEle",w,3e3))},error:function(){utility.notify("请求发生异常，可能是登录状态不对，请验证。如果没有问题，请手动进入未完成订单页面查询。");self.location.reload()}})}function n(n,t){var i=$("#countEle");i.removeClass().addClass(n?"fish_running":"fish_clock").html(t||(n?"正在操作中……":"等待中……"))}function k(n){b.eq(2).find("span").html(utility.getTimeInfo());b.eq(1).find("span").html(n)}function it(){var n=utility.parseJSON(localStorage.getItem("book_passenger")||"[]"),t=localStorage.getItem("book_seat")||"";n.length&&($.each(n,function(){var n=this.passenger_name+this.passenger_id_type_code+this.passenger_id_no;return $("#"+n+" ._checkbox_class").attr("checked",!0).click().attr("checked",!0),!0}),t&&$(".passenger_class").each(function(){$(this).find("select:eq(0)").val(t).change()}))}var h=0,i=0,f=!1,c=/'(dc|fc|wc|gc)'/.exec($("div.tj_btn :button:last")[0].onclick+"")[1]||"dc",l=$("#rand"),a=new Date,o,b,ft,u,rt;if($(".error_text").length>0&&parent.$("#orderForm").length>0){parent.resubmitForm();return}var d=/url\s*:\s*['"]([^'"]+)['"]/i.exec(submit_form_confirm+"")[1],g=/url\s*:\s*['"]([^'"]+)['"]/i.exec(showOrderDialog+"")[1],v=new RegExp("tourFlag\\s*==\\s*['\"]"+c+"['\"](.|\\s)+?['\"]([^'\"]+)['\"]","i").exec(queueOrder+"")[2],nt=/url\s*:\s*['"]([^'"]+)['"]/i.exec(OrderQueueWaitTime.prototype.getWaitTime+"")[1],y=d&&g&&v&&nt;y||alert("嗯……看起来木有找到相关提交地址……so……自动提交已被自动禁用来着……");console.log("[12306订票助手][CONFIRM URL] "+v);var r=function(){$("#img_rrand_code").click();$("#rand").val("")[0].select()},et=function(){return 1e3*Math.max(parseInt($("#pauseTime").val()),1)},p=!1;y&&($("div.tj_btn").append("&nbsp;&nbsp;<button class='long_button_u' type='button' id='btnAutoSubmit'>自动提交<\/button> <button class='long_button_u' type='button' id='btnCancelAuto' style='display:none;'>取消自动<\/button>"),$("#btnAutoSubmit").click(function(){h=0;i=0;f=!0;e()}),$("#btnCancelAuto").click(function(){$(this).hide();i=1;f=!1}),l.keyup(function(n){document.getElementById("autoStartCommit").checked&&!i&&(n.charCode==13||l.val().length==4)&&(f=!0,e())}));o=null;parent&&(o=parent.$("#orderForm"),o.attr("success","1"));$("#rand").closest("tr").after("<tr><td style='border-top:1px dotted #ccc;height:100px;' colspan='9' id='orderCountCell'><\/td><\/tr><tr id='tiptr'><td style='border-top:1px dotted #ccc;' colspan='9'><ul id='tipScript'><li class='fish_clock' id='countEle' style='font-weight:bold;'>等待操作<\/li><li style='color:green;'><strong>操作信息<\/strong>：<span>休息中<\/span><\/li><li style='color:green;'><strong>最后操作时间<\/strong>：<span>--<\/span><\/li><\/ul><\/td><\/tr>");b=$("#tipScript li");ft=0;$("#tiptr").after("<tr><td colspan='9'><div style='display:;'>失败时休息时间：<input type='text' size='4' class='input_20txt' style='text-align:center;' value='3' id='pauseTime' />秒 (设置自动重新提交时的时间间隔不得低于1)  <\/div>安全期时间长度：<input type='text' size='4' class='input_20txt' style='text-align:center;' value='3' id='safeModeTime' />秒 (默认为 <span class='defaultSafeModeTime'><\/span>秒，可以更改试试，过短可能会导致提交时被铁道部踹出去……)  <div><label><input type='checkbox' id='autoStartCommit' /> 验证码戳完自动提交，不选就是你自己戳『提交订单』按钮咯——发生异常（提交不了订单等）的请取消勾选此选项唷<\/label><\/div><label><input type='checkbox' id='autoDelayInvoke' /> 启用安全模式——本页的自动提交会自动推迟到<span class='defaultSafeModeTime'><\/span>秒之后。如果你希望自己掐表，请取消勾选，注意哦，提交过快被铁道部踹出门的~<\/label><\/div><div><label><input type='checkbox' id='showHelp' /> 显示帮助<\/label><\/div><\/td><\/tr>");document.getElementById("autoStartCommit").checked=typeof window.localStorage.disableAutoStartCommit=="undefined";document.getElementById("showHelp").checked=typeof window.localStorage.showHelp!="undefined";document.getElementById("autoDelayInvoke").checked=typeof window.localStorage.autoDelayInvoke=="undefined";$("#autoStartCommit").change(function(){this.checked?window.localStorage.removeItem("disableAutoStartCommit"):window.localStorage.setItem("disableAutoStartCommit","1")});$("#autoDelayInvoke").change(function(){this.checked?window.localStorage.removeItem("autoDelayInvoke"):window.localStorage.setItem("autoDelayInvoke","1")});location.pathname.indexOf("Resign")==-1?$("#showHelp").change(function(){this.checked?(window.localStorage.setItem("showHelp","1"),$("table.table_qr tr:last").show()):(window.localStorage.removeItem("showHelp"),$("table.table_qr tr:last").hide())}).change():$("#showHelp").closest("div").hide();y||$("#pauseTime, #autoStartCommit").parent().hide();u=[],function(){var t=$("#passenger_1_seat option"),n=[];n.push("当前铺位状态查询：");t.each(function(){u.push({id:this.value,name:this.text});n.push("席位【<span style='color:blue; font-weight: bold;'>"+this.text+"<\/span>】余票数: <span class='leftTicketStatusSpan' id='leftTicketStatus_"+this.value+"'>等待查询<\/span>, 排队数: <span class='queueStatusSpan' id='queueStatus_"+this.value+"'>等待查询<\/span>")});$("#orderCountCell").html(n.join("<br />"))}();utility.isfeatureDisabled("ontimeleftticket")?$("span.leftTicketStatusSpan").html("(暂不支持查询或已禁用，<button class='lineButton resetFuncFlag' data-function='ontimeleftticket'>重新启用<\/button>)"):function(){function t(){if(!n){var r={"orderRequest.train_date":$("#start_date").val(),"orderRequest.from_station_telecode":$("#from_station_telecode").val(),"orderRequest.to_station_telecode":$("#to_station_telecode").val(),"orderRequest.train_no":$("#train_no").val(),trainPassType:"QB",trainClass:"QB#D#Z#T#K#QT#",includeStudent:"00",seatTypeAndNum:"","orderRequest.start_time_str":"00:00--24:00"};utility.get("/otsweb/order/querySingleAction.do?method=queryLeftTicket",r,"text",function(n){if(/(([\da-zA-Z]\*{5,5}\d{4,4})+)/gi.test(n)){var r=RegExp.$1;$.each(i,function(){var n=this.id,t=getTicketCountDesc(r,n);$("#leftTicketStatus_"+n).html(t+" ["+utility.getTimeInfo()+"]")});setTimeout(t,6e3)}},function(){},"ontimeleftticket","/otsweb/order/querySingleAction.do?method=init")}}var r={train_date:$("#start_date").val(),station:$("#station_train_code").val(),seat:"",from:$("#from_station_telecode").val(),to:$("#to_station_telecode").val(),ticket:$("#left_ticket").val()},n=!1,i=u.slice(0,u.length+1);$(document).bind("stopcheckcount",function(){n=!0});t()}();utility.isfeatureDisabled("ontimequeuecount")?$("span.queueStatusSpan").html("(暂不支持查询)"):function(){function e(){n||t.length>0&&i()}function i(){if(!n){var u=t.shift();t.push(u);r.seat=u.id;utility.get(f,r,"json",function(n){var t="<span style='color:blue; font-weight: bold;'>"+n.count+"<\/span>，";t+=n.op_2?"<span style='color:blue; font-weight: red;'>排队人数已经超过余票数，可能无法提交<\/span>。":n.countT>0?"排队人数已超过系统参数，<span style='color:red; font-weight: bold;'>排队有危险<\/span>":"请尽快提交";t+=" ["+utility.getTimeInfo()+"]";$("#queueStatus_"+u.id).html(t);setTimeout(i,2e3)},function(){setTimeout(i,3e3)},"ontimequeuecount")}}var r={train_date:$("#start_date").val(),station:$("#station_train_code").val(),seat:"",from:$("#from_station_telecode").val(),to:$("#to_station_telecode").val(),ticket:$("#left_ticket").val()},f="confirmPassengerAction.do?method=getQueueCount",n=!1,t=u.slice(0,u.length+1);$(document).bind("stopcheckcount",function(){n=!0});e()}();$(window).ajaxComplete(function(n,t,i){i.url.indexOf("getpassengerJson")!=-1&&(console.log("[12306订票助手][INFO][自动选择乘客] 系统联系人加载完成，正在检测预先选定"),it())});$("#showPassengerFilter div").length&&(console.log("[12306订票助手][INFO][自动选择乘客] OOPS，居然加载完成了？直接选定联系人"),it()),function(){var n=document.getElementById("rand"),t=window.onload;window.onload=function(){t&&t();n.select()};n.select()}(),function(){$("tr.passenger_class").each(function(){var n=$(this),t=n.attr("id");n.find("td:eq(2)").append("<select id='"+t+"_seat_detail' name='"+t+"_seat_detail'><option value='0'>随机<\/option><option value='3'>上铺<\/option><option value='2'>中铺<\/option><option value='1'>下铺<\/option><\/select>")});var n=$("select[name$=_seat]");n.change(function(){var r=$(this),n=r.val(),t=r.next(),i;n=="2"||n=="3"||n=="4"||n=="6"?t.show():t.hide();i=utility.getPref("_tryBottomSeat")?"1":"";i&&t.val(i).change()}).change()}();rt=function(){function r(){window.isSafeMobeBlocked&&(window.isSafeMobeBlocked=!1,f&&e())}function h(){var i=(new Date-a)/1e3;i>=n?(t.html("保护期已过，你可以安全地提交订单鸟"),r()):(t.html("注入怨念中，等待"+n+"秒钟，建议稍等再提交订单"),window.isSafeMobeBlocked=!0)}$("#tipScript").append("<li style='color:green;' id='safeModeTip'><span><\/span>，已挤进预定页 <span><\/span> 秒……<\/li>");var u=$("#safeModeTip"),t=u.find("span:eq(0)"),s=u.find("span:eq(1)"),o=document.getElementById("autoDelayInvoke"),i=5,n=parseInt(utility.getPref("safeModeWaitTime"))||i;return $("span.defaultSafeModeTime").html(i),$("#safeModeTime").val(n).change(function(){n=parseFloat(this.value)||i;utility.setPref("safeModeWaitTime",n)}),window.isSafeMobeBlocked=o.checked,setInterval(function(){var i=(new Date-a)/100;s.html(Math.round(i)/10);o.checked&&(i>=n*10?(t.html("已达安全期，你可以试着提交订单鸟……不过说不定还是会中枪……"),r()):(t.html("注入怨念中，等待"+n+"秒钟，建议稍等再提交订单"),window.isSafeMobeBlocked=!0))},200),$("#autoDelayInvoke").change(function(){this.checked?h():(t.html("安全模式已关闭"),r())}).change(),this.restart=function(){a=new Date;$("#autoDelayInvoke").change()},this}(),function(){var n=function(){var n=[];n.push(document.getElementById("from_station_telecode").value);n.push(document.getElementById("to_station_telecode").value);n.push(document.getElementById("start_date").value);window.submitReport(49,n)};$(document).ajaxSend(function(t,i,r){if(r.url.indexOf("checkOrderInfo")!=-1)try{n()}catch(t){}})}(),function(){$("table.table_qr").find("input[id$=_name]").width(70);$("table.table_qr").find("input[id$=_cardno]").width(130)}()}function autoCommitOrderInSandbox(){window.localStorage.book_auto&&(window.Audio&&new window.Audio(utility.getAudioUrl()).play(),utility.notify("已经自动进入订票页面！请继续完成订单！"))}function initTicketQuery(){var i=!1,n=$(document),t=$("#gridbox");window.orderButtonClass=".btn130_2";window.datagirdCodeOrder=["","","","","9","P","M","O","6","4","3","2","1","0","*"];window.seatlist={"*":"其它",O:"二等座","3":"硬卧","1":"硬座","2":"软座","4":"软卧","6":"高级软卧",M:"一等座",P:"特等座","9":"商务座","0":"硬座(无座)"};window.seatDefaultPreferOrder=["O","3","1","2","4","6","M","P","9","0"];utility.setPref("book_trainno","");utility.setPref("book_seat","");utility.setPref("book_passenger","");utility.setPref("book_auto","");window.appendTrainCodeToList=function(n){var t=prompt("请输入您要加入列表的车次 (可以使用正则表达式)");if(t){t=t.replace(/(，|,|\/|\\|、|-)/g,"|");try{new RegExp(t)}catch(i){alert("嗯……看起来同学您输入的不是正确的正则表达式哦。");return}n.add(t)}};window.emptyList=function(n){n.emptyList()},function(){window.onbeforeunload=function(){return window.isInAutoRefreshMode()?"助手提示：正在刷票中，确认需要退出刷票吗？":null}}(),function(){$("div.cx_title_w").before('<style type="text/css"> #fishautobook { line-height:20px;  } #fishautobook td { border-bottom:1px dotted #ddd; padding:5px; } #fishautobook td:first-child { background-color:#eee; font-weight:bold; text-right: right; } #fishautobook td:last-child { border-left: 1px dotted #ccc; } #autobookSeatPopup, #passengerPopup {display:inline-block; position:relative;} #fish12306 a{ display:inline-block; text-align:center; width:40px; } #autobookSeatPopup button {width:100%; display:block; margin-top:-1px; }  #autobookSeatPopup:hover div, #passengerPopup:hover div { display:block; } #autobookSeatPopup div, #passengerPopup div {z-index:999; position:absolute; top: 20px; left:0px; border: 1px solid #bbb; padding:3px; background-color:#fff; display:none; width:100px;} #passengerPopup div{width:170px;max-height:400px; overflow:auto; background:#fff;border: 1px solid gray; padding:0;} #passengerPopup div button { display: inline-block; width: 50%; text-align:center; } #passengerPopup p{margin:0px; padding: 5px; line-height:24px; background-color:#f0f0f0;} #gridbox td { cursor: pointer; }\ttr.notset td {background-color:rgb(255, 224, 224);} tr.notset td:first-child{background-color:rgb(226, 183, 183)!important;}\ttr.ok td {background-color:rgb(237, 248, 239);} tr.ok td:first-child{background-color:rgb(182, 228, 185)!important;} #autoPreSubmitStatus { margin-left: 20px; } #autoQueryInfo{display: none;float: none;border-top: 1px dashed #ccc;clear: both;margin-top: 25px;width: auto;line-height: 40px; font-size: 16px;font-weight:bold; padding-top: 5px; padding-left:52px;} #refreshinfo { color:blue; } .running {background:url(data:image/gif;base64,R0lGODlhKwAcAPcAAAAAAAAA/8bGxv///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////yH/C05FVFNDQVBFMi4wAwEAAAAh/htHaWZBbmltIGJ5IE5vYnVoaXJvIEhhdHRvcmkAIfkECQoAAQAsAAAAACsAHAAACMEAAwgcSLCgwYMIEyocCKChw4cOF0os2HCAxYsYLzacKBFAxo8fAXBM6BGkSY0jDZY8yVJkSoErWbZ8GSCmTJMuFUasebOny50MUdrsCVLkypwxBQwl+lEpRqUwn8aseJJq06Q/LwpwmtGqxqVaV25FulUpWKpeTZotmxPmxqFpB8TVChUowqNgLc6FOjIv0bEv/bJkS7Om4Ixs29JsWLax48SFD0Kc/DCy5cuYM2vGTHnyZredKWcOTXrj6NJ2FQYEACH5BAkKAAEALAAAAAArABwAAAjGAAMIHEiwoMGDCBMqHAigocOHDhdKLNhwgMWLGC82nCgRQMaPHwFwTOgRpEmNIw2WPMlSZEqBK1m2fBkgpkyTLkfavIkz5U6eIRdG/Ak0owCREQmurIiTqEWmA44uZYjxqEyoGm1avXgUZlWnGJli5Rqza02uW0+OHYBVQFq3OQG47Up0bdiSdOfmhLnxbFGQcPnuRQiWpV6aNQsbhTv4ZcO5kCPrbYw4McTLfStr3sy5s2fNmC9/FhxaNOfSqDNvTv2QY0AAACH5BAkKAAEALAAAAAArABwAAAjCAAMIHEiwIICDCBMiLMiwoUOBBwdInEhx4sGHGBkCqMiRI4CMIDd2HGkR5EORJFN+NGkwpUuJK1lCfOky5smLAVDSJLlyIUGUH3Xu7Bi05MyJAoQO5ZiUYtKjEptaVEoxYkepUXsixTrVI1WkKAU8hSg26VerVlOaLWsz50WlabuOFBsU50m5I+OClZlz6dWxMr++ZMt3oF6XbNsWPli2sePEhW8qnGw3suXLmDNr3sy5s1vKlTuDpix69GjPpn2aDAgAIfkECQoAAQAsAAAAACsAHAAACMIAAwgcSLAggIMIEyIsyLChQ4EHB0icSHHiwYcYGQKoyJEjgIwgN3YcaRHkQ5EkU340aTClS4krWUJ86TImS5Q0SdoMmbNmxoU4e3YU8HEhQZQRRyZVipIo0oE4idYMOmCpRKkTic7MSrVjUqtcKWoN0BSrTqpWBZhVGxOAWq1dq8aFKRLu251G5+ZkC/HiT6Fi+cqEqpfj3Z2Dybp9y7gxW8SJCSuc7Dey5cuYM2vezLlzX8qVPYOm3Hm0adGmQ2cMCAA7) no-repeat left center;} .failed {background:url(data:image/gif;base64,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) no-repeat left center;} .gotticket {background:url(data:image/gif;base64,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) no-repeat left center;}<\/style><div id=\'fish12306\' style=\'margin-top:10px; margin-bottom:10px;\'><ul class="fish_opt" style="border-radius: 3px 3px 0 0; margin: 0 0 -1px 0;padding: 0;">\t\t<li style="background: -moz-linear-gradient(#F0F0F0, #e5e5e5);background: -webkit-linear-gradient(#F0F0F0, #e5e5e5);line-height: 30px;font-weight: bold;padding-left: 20px;border-right: 1px solid #ddd;">\t\t\t<label><input type="checkbox" name="enableAutoBook" id="enableAutoBook"> 启用车票自动预定<\/label>\t\t<\/li>\t\t<li>\t\t\t<a style="width:170px;" target="_blank" href="http://www.fishlee.net/soft/44/tour.html">功能有疑问？请点这里看教程<\/a>\t\t<\/li>\t\t<li style="float: right;line-height: 30px;text-indent: 0; width:280px; text-align:right;">\t\t\t<input type=\'button\' class=\'lineButton\' style=\'display:none;\' value=\'停止声音\' id=\'btnStopSound\' />\t\t\t<button class=\'fish_button\' id=\'btnAutoRefreshStu\' style=\'margin:0;width:97px;font-size:14px;vertical-align:middle; margin-right:0;\' type=\'button\'>♠ 刷学生票<\/button>\t\t\t<button class=\'fish_button\' id=\'btnAutoRefresh\' type=\'button\' style=\'margin:0;width:97px;font-size:14px;vertical-align:middle;\'>♣ 刷　　票<\/button>\t\t<\/li><\/ul><div id="fishautobook" class="fish_opt" style="padding:0px; border-radius: 3px 3px 0 0; margin: 0 0 -1px 0; overflow: visible;">\t\t<table style="width: 100%;table-layout: fixed; border-collapse: collapse;">\t\t\t<tr>\t\t\t\t<td style="width:50px;font-weight: bold;padding: 5px;">车次<\/td>\t\t\t\t<td style="width:110px;"><a id="btnAddAutoBook" href="javascript:;" class="flatbutton">添加<\/a><a id="btnClearAutoBook" class="flatbutton" href="javascript:;">清空<\/a>\t\t\t\t<\/td>\t\t\t\t<td style="width: auto;" id="autobookListTd"><\/td>\t\t\t\t<td style="width: 100px;"><select id="autoorder_method" style="margin-left:15px;"><option value="0">席别优先<\/option><option value="1">车次优先<\/option><\/select><\/td>\t\t\t<\/tr>\t\t\t<tr>\t\t\t\t<td>席别<\/td>\t\t\t\t<td>\t\t\t\t\t<div id="autobookSeatPopup"><a href="javascript:;" class="flatbutton">选择<small>▼<\/small><\/a><div><\/div><\/div>\t\t\t\t<\/td>\t\t\t\t<td id="fishAutoBookSeatOrder"><\/td>\t\t\t\t<td>\t\t\t\t\t<label style="float:right;"><input type="checkbox" id="tryBottomSeat" name="tryBottomSeat" /> 尝试预定下铺<\/label>\t\t\t\t<\/td>\t\t\t<\/tr>\t\t\t<tr>\t\t\t\t<td>乘客<\/td>\t\t\t\t<td>\t\t\t\t\t<div id="passengerPopup"><a href="javascript:;" class="flatbutton">选择<small>▼<\/small><\/a><div><p><input type="text" placeholder="输入首字母或文字搜索..." id="searchPassenger" disabled="disabled" /><\/p><span>联系人正在加载中，请稍等...<\/span><\/div><\/div>\t\t\t\t<\/td>\t\t\t\t<td id="passengerSelector"><\/td>\t\t\t\t<td>\t\t\t\t\t<label style="float:right;"><input type="checkbox" id="enablePartialSubmit" name="enablePartialSubmit" title="当有票时，如果票数小于此处设置的人数，那么允许按照设置的顺序为前面的人提交订单。" checked="checked" /> 允许部分提交<\/label>\t\t\t\t<\/td>\t\t\t<\/tr>\t\t\t<tr id="removeTrainsNotInAutoOrderLabel">\t\t\t\t<td>选项<\/td>\t\t\t\t<td colspan="3">\t\t\t\t\t<label title="刷票的时候隐藏不需要的车次"><input type="checkbox" id="removeTrainsNotInAutoOrder" name="removeTrainsNotInAutoOrder">隐藏不需要的车次<\/label>\t\t\t\t\t<label title="根据你选择的列车编号，自动为您去除选择其它的车次类型。\n不选择多余的车次类型，将会明显提高刷票成功率。"><input type="checkbox" id="autoCheckTrainClass" name="autoCheckTrainClass">自动选择列车类型<\/label>\t\t\t\t\t<label title="选中此选项，如果没有查询到可定车票，将会自动开始刷票。"><input type="checkbox" id="autoStartRefresh" name="autoStartRefresh" checked="checked">如果无票，自动开始刷票<\/label>\t\t\t\t\t<span id="autoPreSubmitStatus"><\/span>\t\t\t\t<\/td>\t\t\t<\/tr>\t\t<\/table><\/div><ul class=\'fish_opt\' id=\'fishfilter\' style=\'border-radius:2px;margin:0 0 10px 0\'>\t<li id=\'queryinfo\' style=\'width:180px;font-weight:bold;color:royalblue;\'>车次查询结果<\/li>\t\t<li id=\'chkFilterNonBookableLabel\'><label title=\'如果车次不可预定，那就不要显示\'><input type=\'checkbox\' id=\'chkFilterNonBookable\' />过滤不可预订的车次<\/label><\/li>\t\t<li id=\'chkFilterNonNeededLabel\'><label title=\'有时候虽然整趟车可以预定，但是有票的席别都是你不要的，如果勾选此选项，也将会过滤掉\'><input type=\'checkbox\' id=\'chkFilterNonNeeded\' />过滤可定但席别不需要的车次<\/label><\/li>\t\t<li id=\'closeFuseSearchLabel\'><label><input type=\'checkbox\' id=\'closeFuseSearch\'>过滤发站不完全匹配的车次<\/label><\/li>\t\t<li id=\'closeFuseSearch1Label\'><label><input type=\'checkbox\' id=\'closeFuseSearch1\'>过滤到站不完全匹配的车次<\/label><\/li>\t\t<li id=\'autoQueryInfo\' style=\'\'>\t\t\t<span id=\'refreshinfo\' style=\'\'>已刷新 0 次，最后查询：--<\/span>\t\t\t<span id=\'refreshtimer\' style=\'color:red;\'><\/span>\t\t\t<span style=\'margin-left:20px;color:purple;font-weight:bold;\' id=\'serverMsg\'><\/span>\t\t<\/li><\/ul><\/div>').remove();var t=$("#autobookSeatPopup"),i=t.find("div"),n=[];$.each(window.seatDefaultPreferOrder,function(){var t=this=="O"||this=="3"||this=="1"?"font-weight:bold;":"";n.push("<button type='button' class='flat_button' style='"+t+"' data-code='"+this+"'>"+window.seatlist[this]+"<\/button>")});i.append(n.join(""));delete n;$("#enableAutoBook").change(function(){this.checked&&$("#fishautobook, #removeTrainsNotInAutoOrderLabel").show()||$("#fishautobook, #removeTrainsNotInAutoOrderLabel").hide();this.checked||$("table.hdr tr:gt(0):lt(3)").find("button, input").attr("disabled",!1)}).initAsOption();$("#removeTrainsNotInAutoOrder, #tryBottomSeat, #autoorder_method, #enablePartialSubmit, #autoCheckTrainClass, #autoStartRefresh").initAsOption();$("#btnStopSound").click(function(){window.stopSound();$(this).hide()});$("#orderForm").submit(function(){localStorage.book_passenger||(localStorage.book_passenger=utility.toJSON(list_passenger.datalist),localStorage.book_seat=(window.list_seatorder.datalist[0]||{code:""}).code)})}(),function(){function c(){l();window.autoRefreshTimer&&(clearInterval(window.autoRefreshTimer),window.autoRefreshTimer=null);$("#refreshtimer").html("")}function v(){var t=(e-new Date)/1e3,i=Math.round(t*10)/10+"";($("#refreshtimer").html("["+f+i+(i.indexOf(".")==-1?".0":"")+"秒后继续刷票...]"),t>0)||(clearInterval(window.autoRefreshTimer),window.autoRefreshTimer=null,n.trigger("requery"),s(!0))}var u=0,r=null,i=$("#btnAutoRefresh"),t=$("#btnAutoRefreshStu"),f=!1,e=null,h=$("#autoQueryInfo"),o,l,a,s;window.autoRefreshTimer=null;window.stopSound=function(){r&&r.pause()};window.playMusic=function(){window.Audio&&utility.enableMusicPromptOnAutoRefresh&&(r||(r=new Audio(utility.musicPath)),r.loop=utility.musicPromptLoop,$("#btnStopSound").show(),r.play())};window.isInAutoRefreshMode=function(){return i.hasClass("fish_button_highlight")||t.hasClass("fish_button_highlight")};window.startTimer=function(){var s,r,n,u;if(!window.autoRefreshTimer){if(!window.isInAutoRefreshMode()){document.getElementById("autoStartRefresh").checked&&(o(),clickBuyStudentTicket=="N"?i.click():t.click());return}s=(new Date).getMinutes();r=0;window.nextSellTime>=0&&(new Date).getHours()<window.nextSellTime&&time_server?(n=new Date,n.setFullYear(time_server.getFullYear()),n.setMonth(time_server.getMonth()),n.setDate(time_server.getDate()),n.setHours(window.nextSellTime),n.setMinutes(0),n.setSeconds(utility.delayAfterHourStop),r=(n-time_server)/1e3,f="等待起售中, "):utility.enableRefreshWaitOClock&&time_server&&time_server.getMinutes()>=59?(f="等待整点, ",r=62-time_server.getSeconds()):(r=(parseInt(utility.getPref("refereshInterval"))||3)*Math.random()+utility.baseAutoRefreshDelay,f="");e=new Date;e.setSeconds(e.getSeconds()+r);u=Math.round(r*100)/100+"";$("#refreshtimer").html("["+f+u+(u.indexOf(".")==-1?".00":"")+"秒后刷票...]");window.autoRefreshTimer=setInterval(v,100)}};o=function(){h.show().removeClass().addClass("running")};l=function(){h.hasClass("running")?(h.removeClass().addClass("failed"),$("#refreshinfo").html("哎呀，在订票助手努力地刷票 "+u+" 次后，竟然还是没能刷到票....")):$("#refreshinfo").html("订票助手在努力刷票 "+u+" 次后，终于捉到小票票了~~")};i.click(function(){if(i.hasClass("fish_button_highlight"))c(),i.removeClass().addClass("fish_button").html("♣ 刷　　票"),t.attr("disabled",!1);else{if(!canquery()||window.isInAutoRefreshMode())return!1;u=0;o();i.removeClass().addClass("fish_button_highlight").html("■ 停止刷票");t.attr("disabled",!0);clickBuyStudentTicket="N";n.trigger("requery");s()}return!1});t.click(function(){if(t.hasClass("fish_button_highlight"))c(),t.removeClass().addClass("fish_button").html("♠ 刷学生票"),i.attr("disabled",!1);else{if(!canquery()||window.isInAutoRefreshMode())return!1;u=0;o();t.removeClass().addClass("fish_button_highlight").html("■ 停止刷票");i.attr("disabled",!0);clickBuyStudentTicket="Y";n.trigger("requery");s()}return!1});a=function(){u++;$("#refreshinfo").html("订票助手已为您刷票 "+u+" 次，最后刷票时间 "+utility.getTimeInfo());$("#refreshtimer").html("正在查票")};s=function(){window.autoRefreshTimer=null;r&&r.pause();a();sendQueryFunc.call(clickBuyStudentTicket=="Y"?document.getElementById("stu_submitQuery"):document.getElementById("submitQuery"),arguments[0])};n.bind("validTicketsFound",function(){window.isInAutoRefreshMode()&&(c(),utility.notify("主人, 快回来买票!"),window.playMusic(),i.hasClass("fish_button_highlight")&&i.click(),t.hasClass("fish_button_highlight")&&t.click())});canBuyStudentTicket!="Y"&&t.remove()}(),function(){window.ticketType=[];var n={"3":"9","4":"P","5":"M","6":"O","7":"6","8":"4","9":"3","10":"2","11":"1","12":"0","13":"*"};$(".hdr tr:eq(2) td").each(function(i){var r,u,e,f;(ticketType.push(!1),i<3)||(r=$(this),ticketType[i]=(window.localStorage["typefilter_"+i]||"true")=="true",r.attr("otext",r.text()),u=$.trim(r.text()),u.length>2&&(u=u.replace("座","").replace("高级软卧","高软"),r.html(u)),e=$("<input id='seatoption_"+n[i]+"' type='checkbox' typecode='"+n[i]+"' name='seatoption'/>").attr("checked",ticketType[i]),e[0].ticketTypeId=i,e.change(function(){if(document.getElementById("enableAutoBook").checked&&!this.checked&&window.seatLevelOrder&&$.inArray(this.getAttribute("typecode"),window.seatLevelOrder)!=-1){this.checked=!0;alert("禀主子: 由于此席别已经设置了自动预定, 因此必须选择");return}ticketType[this.ticketTypeId]=this.checked;window.localStorage["typefilter_"+this.ticketTypeId]=this.checked}).appendTo(r),f=t.find(".xhdr"),f.length&&f.parent().height(f.height()),t.find(".objbox").css("top",""))});$("table.hdr tr:eq(1) td:eq(2) div").css({position:"relative",overflow:"visible"}).append("<div style='position:absolute;top:-4px;right:0px;'><input type='button' id='chkSeatOnly' value='仅选座票' class='lineButton' title='快速设置席别过滤按钮，点击后可快速勾选所有的座票，包括硬座软座一等座等等' /><input type='button' id='chkSleepOnly' value='仅选卧铺' title='快速设置席别过滤按钮，点击后可快速勾选所有的卧铺，包括硬卧软卧什么的' class='lineButton' /><input type='button' id='chkAllSeat' value='全部席别' class='lineButton' title='快速勾选所有的席别' /><\/div>");$("#chkSeatOnly, #chkSleepOnly").live("click",function(){if(!this.disabled){var n=this.id=="chkSeatOnly"?"座":"卧";$(".hdr tr:eq(2) td").each(function(){var i=$(this),t=i.attr("otext"),r=i.find("input"),u;r.length&&(u=typeof t!="undefined"&&t&&t.indexOf(n)!=-1,r.attr("checked",u).change())})}});$("#chkAllSeat").live("click",function(){this.disabled||$(":checkbox[name=seatoption]").attr("checked",!0).change()})}(),function(){var n=[];n.push("<div style='padding:5px;margin:5px 6px 15px 0;border:1px solid #ccc;background:#f9f9f9;'><strong style='margin-right:10px;'>上次查询信息<\/strong><span id='lastqueryinfo'>还木有查询过。<\/span><\/div>");n.push("<div class='outerbox' id='helperbox' style='margin-right:6px;'><div class='box'><div class='title' style='position:relative;'><big>12306订票助手<\/big>　　<label><input data-target='helpertooltable' id='enableAdvPanel' type='checkbox' />显示高级工具<\/label> <div class='time-comp' title='时间依赖于服务器时间即时计算。受限于您的网速，并不十分准确（需要扣除网速的影响）' id='servertime'>服务器时间：<strong>----<\/strong>，本地时间：<strong>----<\/strong>，服务器比本地 <strong>----<\/strong><\/div><\/div>\t\t<table id='helpertooltable' style='width:100%;'><colgroup><col style='width:110px;' /><col style='width:370px;' /><col style='width:110px;' /><col style='width:auto;' /><\/colgroup>\t\t<tr class='fish_sep' id=''><td colspan='4'><strong>5.3.x版本功能提示：<\/strong><br />1. 自动预定功能已移到车次列表上方; <br />2. 最小票数限制功能已合并为联系人选择，在不选择『允许部分提交』时，选择几个人就限制为几张票。<br />3. 只想刷特定车次的票时，将其添加到自动预定即可<br />4. 尚未预售的票会自动等到预售时间再刷票，因此取消了定点刷票<\/span><\/tr>\t\t<tr class='fish_sep fish_area' id='viewHelper'><td colspan='4'>查询辅助功能<\/span><\/tr>\t\t<tr class='fish_sep fish_area' id='viewFilter'><td colspan='4'>查询过滤功能<\/span><\/tr>\t\t<tr class='fish_sep fish_area' id='queryUtility'><td colspan='4'>其它辅助功能<\/span><\/tr>\t\t<tr class='fish_sep musicFunc' id='helperbox_bottom'><td class='name'>自定义音乐地址<\/td><td colspan='3'><input type='text' id='txtMusicUrl' value='"+utility.getAudioUrl()+"' onfocus='this.select();' style='width:370px;' /> <button class='lineButton' id='btnSelectPresetAudio'>选择内置音乐<\/button> <button class='lineButton' id='btnTestAudio'>测试<\/button> <button class='lineButton' onclick='utility.resetAudioUrl(); document.getElementById(\"txtMusicUrl\").value=utility.getAudioUrl();'>恢复默认<\/button><\/td><\/tr>\t\t<\/td><\/tr>\t\t<tr class='fish_sep'><td colspan='4'>\t\t\t<input  type='button' class='lineButton' type='button' value='设置' id='configLink' tab='tabLogin' />\t\t\t<input type='button' class='lineButton' id='resetSettings' value='清空助手设置' />\t\t\t<input type='button' tab='tabLoginIE' class='lineButton configLink' value='IE登录' />\t\t<\/td><\/tr>\t\t");n.push("<\/table><table style='width:100%;'><tr class='fish_sep'><td class='tfooter' colspan='4'><a style='font-weight:bold;color:#000;text-decoration:underline;' href='http://www.fishlee.net/soft/44/' target='_blank'>12306订票助手 "+utility.spec+"<\/a> 版本 v"+window.helperVersion+" |\t\t<a href='http://t.qq.com/ccfish/' target='_blank'>腾讯微博<\/a> | <a href='http://weibo.com/imcfish/' target='_blank'>新浪微博<\/a> | <a href='http://bbs.fishlee.net/' target='_blank'>助手论坛<\/a> | 注册给 <strong>"+utility.regInfo.name+"，类型 - "+utility.regInfo.typeDesc+"<\/strong> 【<a href='javascript:;' class='reSignHelper'>重新注册<\/a>】<a style='font-weight:bold;text-decoration:underline;margin-left:30px;' href='http://www.fishlee.net/soft/44/donate.html' target='_blank'>捐助作者<\/a><\/td><\/tr>\t\t\t\t<\/table><\/div><\/div>");$("div.enter_w").append(n.join(""));utility.associateSwitch.apply($("#enableAdvPanel"));$("#resetSettings").click(function(){if(confirm("确定要清空助手的所有设置吗？"))return window.localStorage.clear(),self.location.reload(),!1})}(),function(){var t=[],r="http://static.fishlee.net/resources/audio/",n,i;t.push("<div id='tbSelectMusic' class='box' style='width:500px; display:none;'><table style='width:100%;'>");$.each({"音乐":[["music1","超级玛丽"],["music2","蓝精灵"],["song7","未知铃声(柔)"],["song15","卡农"]],"歌曲":[["song3","the day you went away"],["song5","Zo Verliefd"],["song10","红模仿"],["song13","简单爱"],["song16","Tell me"],["song18","庆祝"],["song19","哇啦哇啦"],["song20","蓝色雨"],["song21","相见恨晚"],["song23","有没有那么一首歌会让你想起我"],["song24","水手"],["song6","笔记"],["song8","放开你的心"]],"歌曲(翻唱)":[["song14","今天我要向你告白韩语版"],["song12","加油"],["song17","情非得已"]],"怀旧":[["song11","葫芦兄弟"],["song22","学习雷锋"]],"搞笑":[["song9","搞笑鸡鸣"],["song25","猪八戒背媳妇"]],"警告提示":[["song2","奔腾四广告"],["song4","警笛"]],"其它":[["song1","未知"],["song","经典风格"]]},function(n,i){t.push("<tr><td class='name' style='width:70px;'>"+n+"<\/td><td>");$.each(i,function(){t.push("<a href='javascript:;' url='"+r+this[0]+".ogg' class='murl'>"+this[1]+"<\/a>&nbsp;&nbsp;&nbsp;&nbsp;")});t.push("<\/td><\/tr>")});t.push("<\/table><\/div>");$("body").append(t.join(""));n=null;i=function(){var t=document.getElementById("txtMusicUrl").value;n?(n.pause(),n.src=t,n.play()):(n=new Audio(t),n.play())};$("a.murl").click(function(){$("#txtMusicUrl").val(this.getAttribute("url")).change();i()});$("#btnTestAudio").click(i);$("#btnSelectPresetAudio").click(function(){$.prompt({title:"选择内置音乐",ele:$("#tbSelectMusic"),to:$(this)})});$("#txtMusicUrl").change(function(){utility.musicPath=this.value})}(),function(){$("#stopBut").before("<div class='jmp_cd' style='text-align:center;'><button class='lineButton' id='btnFilter'>加入黑名单<\/button><button class='lineButton' id='btnAutoBook'>自动预定本车次<\/button><\/div>");$("form[name=querySingleForm]").attr("id","querySingleForm");var n=window.onStopHover;window.onStopHover=function(t){$("#stopDiv").attr("info",$.trim($("#id_"+t.split("#")[0]).text()));n.call(this,t);$("#onStopHover").css("overflow","hide")};$("#btnFilter").click(function(){var n=$("#stopDiv").attr("info").split("#")[0];n&&confirm("确定要将车次【"+n+"】加入黑名单？以后的查询将不再显示此车次。")&&list_blacklist.add(n)});$("#btnAutoBook").click(function(){var n=$("#stopDiv").attr("info").split("#")[0];if(isTrainInBlackList(n)){alert("指定的车次在黑名单里呢……");return}n&&confirm("确定要将车次【"+n+"】加入自动预定列表？如果下次查询有符合要求的席别将会自动进入预定页面。")&&list_autoorder.add(n)})}(),function(){window.getTrainNo=function(n){return n.attr("trainCode")||$.trim($("td:eq(0)",n).text())};$("table.obj tr td, #advQueryContainer td").live("checkingTicketSeat",function(n){var i=n.e,t=$.trim(i.text());return n.result=t=="*"||t=="--"||t=="无"?0:ticketType[n.i-1]?document.getElementById("enableAutoBook").checked&&!document.getElementById("enablePartialSubmit").checked&&parseInt(t)<window.list_passenger.datalist.length?1:2:1,n.result});$("table.obj tr, #advQueryContainer tr:gt(0):not(:first)").live("checkTicketRow",function(n){var r=n.trainCode,t=n.row,u,f,i;if(isTrainInBlackList(r))return window.hideByBlackList.push(r),t.remove(),n.result=0,n.result;if(document.getElementById("enableAutoBook").checked&&window.trainSerial)if(utility.getRegCache(window.trainSerial).test(r))window.nextSellTime!=-2&&(u=/>0*(\d+)点起售/.exec(t.find("td:last").html())&&parseInt(RegExp.$1)||-1,window.nextSellTime=u!=-1?window.nextSellTime==-1?u:Math.min(window.nextSellTime,u):-2);else return n.result=0,document.getElementById("removeTrainsNotInAutoOrder").checked&&window.list_autoorder.datalist.length>0&&t.remove(),0;else window.nextSellTime!=-2&&(f=/>0*(\d+)点起售/.exec(t.find("td:last").html())&&parseInt(RegExp.$1)||-1,window.nextSellTime=f!=-1?window.nextSellTime==-1?f:Math.min(window.nextSellTime,f):-2);return $("a.btn130",t).length>0?(n.result=0,n.result):(i=1,$("td",t).each(function(n,u){if(!(n<4)&&!(n>14)){u=$(u);var f=$.extend(new $.Event("checkingTicketSeat"),{i:n,e:u,code:r,tr:t,index:u.index(),seatType:u.attr("scode")});f.result=null;u.trigger(f);u.attr("result",f.result);f.result==2?(i=2,u.addClass("validCell")):u.addClass("unValidCell")}}),t.attr("result",i),n.result=i,i)})}(),function(){$("body").ajaxComplete(function(t,i,r){var f;if(r.url.indexOf("queryLeftTicket")!=-1){n.trigger("checkingTicket");var o=$("table.obj tr:gt(0)"),u=!1,e={};o.each(function(){var n=$(this),r=getTrainNo(n),s,f,h,c,l,t,i,o;for(n.attr("tcode",r),n.find("td:eq(0)").click(putTrainCodeToList),s=n.find("td"),f=0;f<s.length;f++)s[f].setAttribute("scode",window.datagirdCodeOrder[f]);h=n.find(orderButtonClass);h.length&&(c=h[0].onclick+"",l=utility.getTicketInfo(c),$.each(l,function(t,i){var r=n.find("td[scode="+t+"]");$.trim(r.text())=="有"&&r.html(i)}));t=new $.Event("checkTicketRow");t.trainCode=r;t.row=n;i=$.trim(n.find("td:eq(1)").text()).split(/\s+/);t.fromStation=i[0];t.fromTime=i[1];i=$.trim(n.find("td:eq(2)").text()).split(/\s+/);t.toStation=i[0];t.toTime=i[1];n.trigger(t);o=t.result;o==2?(n.addClass("validRow"),e[r]=n):(n.addClass("unValidRow"),o==1&&(window.noNeed.push(r),document.getElementById("chkFilterNonNeeded").checked&&n.remove()),o==0&&(window.noTicket.push(r),document.getElementById("chkFilterNonBookable").checked&&n.remove()));u=u||o==2});n.trigger("checkedTicket");u?($("#autoQueryInfo").removeClass().addClass("gotticket"),f=new $.Event("validTicketsFound"),f.rows=e,n.trigger(f)):(n.trigger("noticket"),startTimer())}})}(),function(){$("#orderForm").submit(function(){parent.$("#orderForm").remove();parent.$("body").append($("#orderForm").clone(!1).attr("target","main").attr("success","0"))})}(),function(){$("body").ajaxComplete(function(n,t,i){i.url.indexOf("/otsweb/order/querySingleAction.do")!=-1&&t.responseText=="-1"?(invalidQueryButton(),delayButton(),startTimer()):$("#serverMsg").html("")});$("body").ajaxError(function(n,t,i){i.url.indexOf("queryLeftTicket")!=-1&&i.url.indexOf("/otsweb/order/querySingleAction.do")!=-1&&(delayButton(),startTimer())})}(),function(){var n=window.sendQueryFunc;window.sendQueryFunc=function(){var i=n.apply(this,arguments),t;if(window.nextSellTime=-1,$(document).trigger("beginQueryTicket"),window.stopSound(),$("#fromStationText")[0].disabled||(utility.setPref("_from_station_text",$("#fromStationText").val()),utility.setPref("_from_station_telecode",$("#fromStation").val()),utility.setPref("_to_station_text",$("#toStationText").val()),utility.setPref("_to_station_telecode",$("#toStation").val()),utility.setPref("_depart_date",$("#startdatepicker").val()),utility.setPref("_depart_time",$("#startTime").val())),arguments[0]!==!0)try{t=[];t.push(document.getElementById("fromStation").value);t.push(document.getElementById("toStation").value);t.push(document.getElementById("startdatepicker").value);t.push(document.getElementById("startTime").value=="00:00--24:00"?0:1);t.push(window.list_blacklist.datalist.length>0?1:0);t.push($("#gridbox input[name=seatoption]:not(:checked)").length?1:0);t.push(window.list_autoorder.datalist.length>0?1:0);t.push(clickBuyStudentTicket=="Y"?1:0);window.submitReport(window.isInAutoRefreshMode()?47:48,t)}catch(r){}return i};$("#submitQuery, #stu_submitQuery").unbind("click",n).click(window.sendQueryFunc)}(),function(){var n;if(!$("#fromStationText")[0].disabled){var t=utility.getPref("_from_station_text"),r=utility.getPref("_from_station_telecode"),u=utility.getPref("_to_station_text"),f=utility.getPref("_to_station_telecode"),i=utility.getPref("_depart_date"),e=utility.getPref("_depart_time");t&&($("#fromStationText").val(t),$("#fromStation").val(r),$("#toStationText").val(u),$("#toStation").val(f),n=new Date,n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0),new Date(i)>=n&&$("#startdatepicker").val(i),$("#startTime").val(e))}}(),function(){var n=$("table.cx_from tr:eq(0) td:eq(5), table.cx_from tr:eq(1) td:eq(3)");n.width("170px");n.find("input").width("80px").css({"margin-right":"1px","margin-left":"1px"}).before('<input type="button" style="margin-right:0;" class="date_prev lineButton" value="&lt;">').after('<input style="margin-right:0; style="margin-left:0;"" type="button" class="date_next lineButton" value="&gt;">');n.find(".date_prev").click(function(){var n=$(this).next();n.val(utility.formatDate(utility.addTimeSpan(utility.parseDate(n.val()),0,0,-1,0,0,0))).change()});n.find(".date_next").click(function(){var n=$(this).prev();n.val(utility.formatDate(utility.addTimeSpan(utility.parseDate(n.val()),0,0,1,0,0,0))).change()})}(),function(){var t="<tr class='fish_sep' id='autoChangeDateRow'><td class='name'>自动轮查<\/td><td><label><input type='checkbox' id='autoChangeDate' /> 无票时自动更改日期轮查<\/label><\/td><td><\/td><td><\/td><\/tr><tr class='fish_sep' style='display:none;'><td class='name'>轮查日期设置<\/td><td colspan='3' id='autoChangeDateList'><\/td><\/tr>\t",i,e,f,o;$("#viewHelper").after(t);var r=$("#autoChangeDateList"),t=[],u=new Date;for(i=0;i<20;i++)t.push("<label style='margin-right:16px;'><input type='checkbox' value='"+utility.formatDate(u)+"' cindex='"+i+"' />"+utility.formatDateShort(u)+"<\/label>"),(i+1)%10==0&&t.push("<br />"),u=utility.addTimeSpan(u,0,0,1,0,0,0);r.html(t.join(""));$("#autoChangeDate").change(function(){var n=$(this).closest("tr").next();this.checked?n.show():n.hide()});$("#autoChangeDateRow").initAsOption("autoChangeDateRow");e="autoChangeDateRow_dates";f=window.localStorage.getItem(e);typeof f!="undefined"&&f&&(o=f.split("|"),r.find(":checkbox").each(function(){this.checked=$.inArray(this.value,o)!=-1}));r.find(":checkbox").change(function(){var n=$.map(r.find(":checkbox:checked"),function(n){return n.value}).join("|");window.localStorage.setItem(e,n)});n.bind("noticket",function(n){var i,t;if(!n.result&&document.getElementById("autoChangeDate").checked){if(i=$("#autoChangeDateList input.current"),i.removeClass("current"),t=null,i.length){if(t=i.parent().nextAll(":has(:checked):eq(0)").find("input"),t.length?n.result=!0:t=$("#autoChangeDateList :checkbox:checked:eq(0)"),!t.length)return}else{if(t=$("#autoChangeDateList :checkbox:checked:eq(0)"),!t.length)return;n.result=!0}t.addClass("current");$("#startdatepicker").val(t.val())}})}(),function(){var n=window.alert;window.alert=function(t){t.indexOf("服务器忙")!=-1?$("#serverMsg").text(t):n(t)}}(),function(){$("#viewFilter").after("<tr class='fish_sep caption' style='line-height:26px;'><td colspan='2'><label title='加入白名单的车次，将不会被过滤(仅为搭配黑名单)'><input type='checkbox' id='swWhiteList' name='swWhiteList' checked='checked' /> 一定要看到的车次<\/label><div style='float:right;'><button class='lineButton' id='btnAddWhite'>添加<\/button><button class='lineButton' id='btnClearWhite'>清空<\/button><\/div><\/td><td colspan='2'><label title='加入黑名单的车次，除非在白名单中，否则会被直接过滤而不会显示'><input type='checkbox' id='swBlackList' checked='checked' name='swBlackList' />打死你也不想看到的车次<\/label><div style='float:right;'><button class='lineButton' id='btnAddBlack'>添加<\/button><button class='lineButton' id='btnClearBlack'>清空<\/button><\/div><\/td><\/tr><tr class='fish_sep'><td colspan='2' id='whiteListTd'><\/td><td colspan='2' id='blackListTd'><\/td><\/tr>");list_blacklist=utility.selectionArea.call($("#blackListTd"),{syncToStorageKey:"list_blackList"});list_whitelist=utility.selectionArea.call($("#whiteListTd"),{syncToStorageKey:"list_whiteList"});$("#btnAddWhite").click(function(){window.appendTrainCodeToList(list_whitelist)});$("#btnAddBlack").click(function(){window.appendTrainCodeToList(list_blacklist)});$("#btnClearWhite").click(function(){window.emptyList(list_whitelist)});$("#btnClearBlack").click(function(){window.emptyList(list_blacklist)});window.isTrainInBlackList=function(n){return document.getElementById("swBlackList").checked&&list_blacklist.isInRegList(n)&&!(document.getElementById("swWhiteList").checked&&list_whitelist.isInRegList(n))};window.putTrainCodeToList=function(){var n=$(this).closest("tr").attr("tcode");confirm("是否要将【"+n+"】加入自动预定列表？如果不是，请点击取消并继续选择是否加入黑名单或白名单。")?list_autoorder.add(n):confirm("是否要将【"+n+"】加入黑名单？如果不是，请点击取消并继续选择是否加入白名单。")?list_blacklist.add(n):confirm("是否要将【"+n+"】加入白名单？")&&list_whitelist.add(n)}}(),function(){var n=$("input:checkbox[name=trainClassArr]"),t=(utility.getPref("cctype")||"").split("|");t[0]&&n.each(function(){this.checked=$.inArray(this.value,t)!=-1});n.click(function(){utility.setPref("cctype",$.map(n.filter(":checked"),function(n){return n.value}).join("|"))})}(),function(){var t=$("#fromStation"),n=$("#fromStationText"),i=$("#toStation"),r=$("#toStationText");n.css("width","60px").after("<input style='margin-right:0;padding:0 2px 0 2px; line-height: 20px;' type='button' value='<>' class='lineButton' title='交换出发地和目的地' id='btnExchangeStation' />");$("#toStationText");$("#btnExchangeStation").click(function(){var u=t.val(),f=n.val();t.val(i.val());n.val(r.val());i.val(u);r.val(f)})}(),function(){function n(){var n=null;utility.get("/otsweb/main.jsp",null,"text",function(t,i,r){n=new Date(r.getResponseHeader("Date"));time_offset=new Date-n},null,"","https://dynamic.12306.cn/otsweb/")}window.time_offset=null;window.time_server=null;setTimeout(n,5e3);setInterval(n,6e5)}(),function(){function t(){if(window.time_offset!==null){var t=new Date;window.time_server=new Date;window.time_server.setTime(t.getTime()-window.time_offset);$("#chkSmartSpeed, .needServerTime").attr("disabled",window.time_server.getFullYear()<2e3);n.eq(0).html(window.utility.formatTime(time_server));n.eq(1).html(window.utility.formatTime(t));n.eq(2).html((window.time_offset<0?"快":"慢")+Math.abs(window.time_offset)/1e3+"秒")}}var n=$("#servertime strong");setInterval(t,1e3);t()}(),function(){function e(n){return utility.parseJSON(window.localStorage.getItem("theme_"+n))}function r(n,t){t?window.localStorage.setItem("theme_"+n,utility.toJSON(t)):window.localStorage.removeItem(n)}function u(){var n={};return n.blackListEnabled=document.getElementById("swBlackList").checked,n.whiteListEnabled=document.getElementById("swWhiteList").checked,n.autoBookListEnabled=document.getElementById("enableAutoBook").checked,n.seatOrder=window.list_seatorder.datalist||[],n.prePassenger=window.list_passenger.datalist,n.whiteList=window.list_whitelist.datalist,n.blackList=window.list_blacklist.datalist,n.autoBookList=window.list_autoorder.datalist,n.autoBookMethod=$("#autoorder_method").val(),n.queryInfo=$("#querySingleForm").serializeArray(),n.removeTrainsNotInAutoOrder=$("#removeTrainsNotInAutoOrder")[0].checked,n}function f(n){typeof n.removeTrainsNotInAutoOrder=="undefined"&&(n.removeTrainsNotInAutoOrder=!0);$("#swBlackList").attr("checked",n.blackListEnabled).change();$("#swWhiteList").attr("checked",n.whiteListEnabled).change();$("#enableAutoBook").attr("checked",n.autoBookListEnabled).change();window.list_seatorder.emptyList();$.each(n.seatOrder,function(){window.list_seatorder.add(this)});window.list_autoorder.emptyList();$.each(n.autoBookList,function(){window.list_autoorder.add(this)});window.list_passenger.emptyList();$.each(n.prePassenger,function(){window.list_passenger.add(this)});list_whitelist.emptyList();$.each(n.whiteList,function(){list_whitelist.add(this+"")});list_blacklist.emptyList();$.each(n.blackList,function(){list_blacklist.add(this+"")});$("#autoorder_method").val(n.autoBookMethod).change();$("#removeTrainsNotInAutoOrder").attr("checked",n.removeTrainsNotInAutoOrder).change();n.queryInfo&&$.each(n.queryInfo,function(){this.name.indexOf("orderRequest.")!=-1&&$("input[name="+this.name+"]").val(this.value).change()});utility.notify("已加载出行模式")}$("#helpertooltable tr:first").before("<tr class='fish_sep fish_area'><td colspan='4' title='出行模式可以帮你快速的保存一系列设置，如联系人、车次、席别、黑名单和白名单'>出行模式<\/td><\/tr><tr class='fish_sep'><td colspan='4'><select id='profilelist'><option value=''>==选择一个出行模式==<\/option><\/select><button id='profile_save' class='lineButton'>保存<\/button><button id='profile_add' class='lineButton'>另存<\/button><button id='profile_delete' class='lineButton'>删除<\/button><button id='profile_reset' class='lineButton'>重置所有选项<\/button><\/td><\/td><\/tr>");var n=(window.localStorage.themelist||"").split("\t"),t=$("#profilelist"),i=t[0];n[0]==""&&n.splice(0,1);$.each(n,function(){i.options[i.options.length]=new Option(this+"",this+"")});t.change(function(){var n=t.val();n&&f(e(n))});$("#profile_save").click(function(){t.val()?(r(t.val(),u()),alert("存档已经更新~")):$("#profile_add").click()});$("#profile_add").click(function(){var f=u(),t=prompt("请输入出行模式的名称，如『出去鬼混』神马的……","嗷嗷回家~");t&&(t=t.replace(/\s+/g,""),window.localStorage.getItem("theme_"+t)?alert("啊嘞？这个名字的已经有了喔，重试呗~"):(r(t,f),n.push(t),i.options[i.options.length]=new Option(t,t),window.localStorage.setItem("themelist",n.join("\t")),alert("已保存唷。")))});$("#profile_delete").click(function(){var t=i.selectedIndex;t&&confirm("亲，确定要下此狠手咩？")&&(i.options[t]=null,window.localStorage.removeItem("theme_"+n[t-1]),n.splice(t-1,1),window.localStorage.setItem("themelist",n.join("\t")),alert("乃伊佐特~"))});$("#profile_reset").click(function(){t.val("");f({blackListEnabled:!0,whiteListEnabled:!0,autoBookListEnabled:!0,seatOrder:[],prePassenger:[],whiteList:[],blackList:[],autoBookList:[],autoBookMethod:"1"})})}(),function(){var t=null,n=$("#lastqueryinfo");$(document).ajaxComplete(function(i,r,u){var e,s;if(u.url.indexOf("method=queryLeftTicket")!=-1&&r.responseText!="-1"){var h=r.getResponseHeader("Age"),c=r.getResponseHeader("X-Cache")||"",f=r.getResponseHeader("Date")||"<未知>",o="<未知>";f&&(f=new Date(f),o=utility.formatTime(f));e=h==1||f==t||c.indexOf("HIT")!=-1;s="服务器返回的数据时间："+o;n.html(s+(e?" （貌似这是缓存过来的数据）":""));e?n.addClass("warning"):n.removeClass("warning")}})}();utility.isChrome||utility.isLiebaoIntel||utility.isLieBaoEdition||function(){var t=[],i=$("input[name=trainClassArr]"),r;t.push("<tr class='fish_sep' id='trAutoChangeClass'><td class='name'><label title='选择肯定不要的列车类型，每次查询后小的会随机更改查询条件，好查得更及时~'><input type='checkbox' name='autoChangeTrainClass' id='autoChangeTrainClass' /> 更改列车类型<\/label><\/td><td colspan='3'>");i.each(function(){this.value!="QB"&&t.push("<label style='margin-right:10px;'><input type='checkbox' id='unwantClass_"+this.value+"' name='unwantClass' value='"+this.value+"' /> "+$(this).parent().text()+"<\/label>")});t.push("<\/td><\/tr>");$("#viewHelper").nextUntil(".fish_area").last().after(t.join(""));$("#trAutoChangeClass input,#trAutoChangeClass select").initAsOption();r=$("#trAutoChangeClass :checkbox[name=unwantClass]");n.bind("checkedTicket",function(){var n,t;if(document.getElementById("autoChangeTrainClass").checked)for(i[0].checked=!1,n=0;n<r.length;n++)t=r[n],i[n+1].checked=t.checked?Math.random()>=.5:!0})}(),function(){window.SetISPos=function(n){var t=n.offset();$("#form_cities, #form_cities2").css({left:t.left,top:t.top+n.height()+3})};return}(),function(){$(".objbox").append('<div id="ticketCellTip" style="color: #AAAAAA;border: 1px solid #CACACA;width: 500px;position: relative;left: 50%;top: 50%;margin-top: -70px;margin-left: -250px;padding: 10px;line-height: 29px;box-shadow: 0px 0px 5px #ddd;border-radius: 5px;"><h4>致小主：<\/h4><ol style="margin-left: 10px;"><li>1. 如果您要预定的车次无票，请点击『刷  票』开始刷票<\/li><li>2. 查票结果中，除了预定按钮可以预定外，各有票的席别格子可以直接预定指定席别<\/li><li>3. 无票的席别格子可以自动把对应的车次和席别加入自动预定列表<\/li><li>4. 把鼠标移到车次上，也可以将该车次直接添加到自动预定<\/li><li>5. 我是凑数的，因为4这个数字实在太不吉利了<\/li><\/ol><\/div>').append('<div id="noTicketTip" style="display:none; color: #2E449E;border: 1px solid #CACACA;width: 500px;position: relative;left: 50%;top: 50%;margin-top: -70px;margin-left: -250px;padding: 10px;line-height: 29px;box-shadow: 0px 0px 5px #ddd;border-radius: 5px;"><h4>丫的，没有查到车次！<\/h4><ol style="margin-left: 10px;"><\/ol><\/div>');$(document).bind("beginQueryTicket",function(){$("#ticketCellTip").remove();$("#noTicketTip").hide()});$(document).bind("noResultFound",function(){var n=[];($("#timeFilterFrom1").val()!=0||$("#timeFilterFrom2").val()!=24)&&n.push("<li>-&gt; 当前设置的出发时间限制是： <strong>"+$("#timeFilterFrom1").val()+":00<\/strong> 到 <strong>"+$("#timeFilterFrom2").val()+":00<\/strong>，请确认正确；<\/li>");($("#timeFilterTo1").val()!=0||$("#timeFilterTo2").val()!=24)&&n.push("<li>-&gt; 当前设置的到达时间限制是： <strong>"+$("#timeFilterTo1").val()+":00<\/strong> 到 <strong>"+$("#timeFilterTo2").val()+":00<\/strong>，请确认正确；<\/li>");$("#enableAutoBook:checked, #removeTrainsNotInAutoOrder:checked").length==2&&n.push("<li>-&gt; 看起来主子设置了自动预定并筛选了不在列表的车次，麻烦确认下设置的车次正确诶；<\/li>");$("input[name=trainClassArr][value=QB]:checked").length||n.push("<li>-&gt; 好像有筛选车次类型，看看是不是少选了？<\/li>");$("#fishfilter input:checked").length&&n.push("<li>-&gt; 有过滤选项被启用了，检查看看？（不显示无票什么的）；<\/li>");n.push("<li>-&gt; 如果查询的是今天的票，可能已经木有车次了；<\/li>");n.push("<li>-&gt; 有时候系统有点问题，请重试看看；<\/li>");$("#noTicketTip").show().find("ol").html(n.join(""))})}(),function(){window.checkedAutoSubmitState=function(){window.list_seatorder&&window.list_passenger&&window.list_autoorder&&(window.list_seatorder.count&&window.list_autoorder.count?$("#autoPreSubmitStatus").css("color","green").html("自动预定已经设置完成，查到票后将会自动为您转到提交页面"+(window.list_passenger.count==0?"<strong style='color:red;'>(不选乘客吗？)<\/strong>":"")):$("#autoPreSubmitStatus").css("color","red").html("自动预定还未完成设置，查到票后不会为您自动预定"))}}(),function(){function n(){var n=$.map(this.datalist,function(n){return n.code});(window.seatLevelOrder=n,document.getElementById("enableAutoBook").checked)&&(i||this.count!=0)&&($("#gridbox input[name=seatoption]").each(function(){var t=$(this),i=t.attr("typecode");t.attr("checked",n.length==0||$.inArray(i,n)!=-1).change()}),$("table.hdr tr:gt(0):lt(3)").find("button, input").attr("disabled",n.length>0),t.parent().removeClass("ok notset").addClass(this.count?"ok":"notset"),window.checkedAutoSubmitState())}var t=$("#fishAutoBookSeatOrder"),i=!1;window.list_seatorder=utility.selectionArea.call(t,{syncToStorageKey:"autobook_seat",onAdd:function(t){var i=t.code;$("#autobookSeatPopup button[data-code="+i+"]").attr("disabled",!0);n.call(this)},onRemove:function(t){var i=t.code;$("#autobookSeatPopup button[data-code="+i+"]").attr("disabled",!1);n.call(this)},onClear:function(){$("#autobookSeatPopup button").attr("disabled",!1);n.call(this)},comparer:function(n,t){return n.code==t.code},emptyText:"还没有添加席别，请将鼠标移动到『选择』按钮上添加"});window.list_seatorder.isSeatSelected=function(n){return $.inArrayEx(n,this.datalist,0,function(n,t){return n.code==t})!=-1};n.call(window.list_seatorder);$("#autobookSeatPopup button").click(function(){var n=$(this),t=n.attr("data-code");window.list_seatorder.add({code:t,text:n.text()})});$("#enableAutoBook").change(function(){this.checked&&n.call(window.list_seatorder)}).change();i=!0}(),function(){window.trainSerial="";var n=function(){if(window.trainSerial=this.count?"^("+this.datalist.join("|")+")$":"",document.getElementById("autoCheckTrainClass").checked){var n={},t=0;$.each(this.datalist,function(){if(!/^[a-z\d]+$/i.test(this+""))return n=null,!1;"CDGKTZ".indexOf(this[0])!=-1?n[this[0].toUpperCase()]=!0:n.QT=!0;t++});$("input[name=trainClassArr], input[name=advDgFilter]").each(function(){var i=this.value=="on"?this.id[this.id.length-1]+"":this.value;this.checked=n[i]||t==0;$(this).change()})}$("#autobookListTd").parent().removeClass("ok notset").addClass(this.count?"ok":"notset");window.checkedAutoSubmitState()};window.list_autoorder=utility.selectionArea.call($("#autobookListTd"),{onAdd:n,onRemove:n,onClear:n,syncToStorageKey:"list_autoBookList",emptyText:"还没有添加车次。您可以在车次查询结果中双击『无票』的格子直接添加，或在停靠站查询中添加。"});n.call(window.window.list_autoorder);$("#btnAddAutoBook").click(function(){window.appendTrainCodeToList(window.list_autoorder)});$("#btnClearAutoBook").click(function(){window.emptyList(window.list_autoorder)})}(),function(){var i=$("#passengerSelector"),n=$("#passengerPopup"),t=function(){i.parent().removeClass("ok notset").addClass(this.count||!0?"ok":"notset");window.checkedAutoSubmitState()},r,u;window.list_passenger=utility.selectionArea.call(i,{syncToStorageKey:"autobook_passenger",onAdd:function(i){n.find("button[data-key="+i.key+"]").attr("disabled",!0);t.call(this)},onRemove:function(i){n.find("button[data-key="+i.key+"]").attr("disabled",!1);t.call(this)},onClear:function(){n.find("button").attr("disabled",!1);t.call(this)},emptyText:"还没有添加联系人，请将鼠标移动到『选择』按钮上添加"});t.call(window.list_passenger);r=function(){if(window.list_passenger.datalist.length>4){alert("联系人不可以多于五人哦");return}window.list_passenger.add(window.passengers[this.dataset.key])};u=function(){window.passengers={};utility.getAllPassengers(function(t){var i=[];$.each(t,function(){this.text=this.passenger_name+(this.passenger_type==2?" (儿童)":this.passenger_type==3?" (学生)":"");this.key=this.passenger_name+"$"+this.passenger_id_no;window.passengers[this.passenger_name+"$"+this.passenger_id_no]=this;i.push("<button data-key='"+this.key+"' class='flat_button' data-letter='"+this.first_letter+"'>"+this.text.replace(/\s/g,"")+"<\/button>")});n.find("div").append(i.join("")).find("span").remove();n.find("button[data-key]").click(r);document.getElementById("searchPassenger").disabled=!1;$.each(window.list_passenger.datalist,function(){n.find("button[data-key="+this.key+"]").attr("disabled",!0)})})};setTimeout(u,1e3);$("#searchPassenger").keyup(function(){var t=this.value;t?(n.find("button").hide(),n.find("button[data-letter*="+t.toUpperCase()+"], button[data-key*="+t+"]").show()):n.find("button").show()})}(),function(){n.bind("checkingTicket",function(){window.fromNotSame=[];window.toNotSame=[];window.noTicket=[];window.noNeed=[];window.hideByAutoBook=[];window.hideByBlackList=[]});n.bind("checkedTicket",function(){var t=$("table.obj tr:gt(0)").length;$("#queryinfo").html("查到 <span style='color:red;'>"+t+"<\/span> 趟车");t||n.trigger("noResultFound");window.fromNotSame.length&&$("#closeFuseSearchLabel").show()||$("#closeFuseSearchLabel").hide();window.toNotSame.length&&$("#closeFuseSearch1Label").show()||$("#closeFuseSearch1Label").hide();window.noTicket.length&&$("#chkFilterNonBookableLabel").show()||$("#chkFilterNonBookableLabel").hide();window.noNeed.length&&$("#chkFilterNonNeededLabel").show()||$("#chkFilterNonNeededLabel").hide()})}(),function(){var t=$("#fromStationText"),i=$("#toStationText"),n=$("#closeFuseSearch, #closeFuseSearch1");n.parent().attr("title","默认情况下，例如查找‘杭州’时，会包括‘杭州南’这个车站。勾选此选项，将会在搜索‘杭州’的时候，过滤那些不完全一致的车站，如‘杭州南’。");$("#fishfilter li:gt(0)").hide().find("input").initAsOption();$("table.obj tr").live("checkTicketRow",function(r){return r.fromStation!=t.val()&&(window.fromNotSame.push(r.trainCode),n[0].checked)?(r.row.remove(),r.result=0,!1):r.toStation!=i.val()&&(window.toNotSame.push(r.trainCode),n[1].checked)?(r.row.hide(),r.result=0,!1):!0})}(),function(){var t=function(){var r=$(this),e=r.index(),s;if(!(e<4)&&!(e>14)){var u=r.parent(),f=r.text(),o=f=="--"?-2:f=="无"?-1:f=="有"?100:parseInt(f),t=window.datagirdCodeOrder[e],i=window.seatlist[t],n=u.attr("tcode");if(o>0){if(!document.getElementById("enablePartialSubmit").checked&&window.list_passenger.datalist.length>parseInt(r.text())&&!confirm("主子，查询结果的票数比您选择的联系人数目少。\n点确定继续购票，点取消把这个车次和席别加入自动预定列表。")){window.list_autoorder.add(n);window.list_seatorder.add({code:t,text:i});return}utility.setPref("book_trainno",n);utility.setPref("book_seat",t=="0"?"1":t);utility.setPref("book_passenger",utility.toJSON(utility.arrayTake(window.list_passenger.datalist,Math.min(parseInt(r.text(),window.list_passenger.datalist)))));u.find("td:last *").click();return}if(s=u.attr("result"),s>0){if(confirm("小主，车次【"+n+"】的席别【"+i+"】无票，但是这趟车的其它席别有票。\n点击『确定』继续购票，点击『取消』加入自动预定列表。")){utility.setPref("book_trainno",n);utility.setPref("book_seat","");utility.setPref("book_passenger",utility.toJSON(window.list_passenger.datalist));u.find("td:last *").click();return}window.list_autoorder.add(n);window.list_seatorder.add({code:t,text:i});return}if(o!=-2){if(confirm("小主，车次【"+n+"】的席别【"+i+"】无票，咱是否把它加入自动预定列表？")){window.list_autoorder.add(n);window.list_seatorder.add({code:t,text:i});return}return}alert("车次【"+n+"】无席别【"+i+"】")}};n.bind("checkedTicket",function(){$("#gridbox .objbox td").click(t)})}();i=!0}function initAutoPreSubmitOrder(){$(document).bind("validTicketsFound",function(n){function h(n,t,i){utility.setPref("book_trainno",n.attr("tcode"));utility.setPref("book_seat",t=="0"?"1":t);utility.setPref("book_auto",1);utility.setPref("book_passenger",utility.toJSON(i));n.find(orderButtonClass).click()}var f,e,o,t,s;if(document.getElementById("enableAutoBook").checked&&typeof window.seatLevelOrder!="undefined"&&window.seatLevelOrder.length&&typeof window.list_autoorder!="undefined"&&window.list_autoorder.datalist.length&&(n.result==null||n.result)){var u=function(n){var i=this.find("td[scode="+n+"][result=2]"),t;return i.length?(t=parseInt(i.text()),!document.getElementById("enablePartialSubmit").checked&&t<window.list_passenger.datalist.length)?!1:(t=Math.min(t,window.list_passenger.datalist.length),n=n=="0"?"1":n,h(this,n,utility.arrayTake(window.list_passenger.datalist,t)),!0):!1},i=$.makeArray($("#gridbox tr[result=2]")),r=[];for(f in list_autoorder.datalist)for(e=list_autoorder.datalist[f],o=utility.getRegCache(e),t=i.length-1;t>=0;t--)s=i[t].getAttribute("tcode"),o.test(s)&&(r.push($(i[t])),i.splice(t,1));document.getElementById("autoorder_method").selectedIndex==0?$.each(window.seatLevelOrder,function(){var t=this,n;for(n in r)if(u.call(r[n],t))return!1;return!0}):$.each(r,function(){var t=this,n;for(n in window.seatLevelOrder)if(u.call(this,window.seatLevelOrder[n]))return!1;return!0})}})}function dgFilterQuery(){(function(){var u=$("input:checkbox[name=trainClassArr][value=D]"),t=$("input:checkbox[name=trainClassArr][value=QB]"),n=$("input:checkbox[name=trainClassArr][value!=QB][value!=D]"),r;u.closest("li").hide().after("<li><label title='助手添加的动车过滤框，不包含高铁~'><input checked='checked' type='checkbox' name='advDgFilter' id='advDgFilterD' />动车<\/label><\/li><li><label title='助手添加的动车过滤框，不包含动车~'><input type='checkbox' checked='checked' name='advDgFilter' id='advDgFilterG' />高铁<\/label><\/li><li><label title='助手添加的城铁过滤框'><input checked='checked' type='checkbox' name='advDgFilter' id='advDgFilterC' />城铁<\/label><\/li>").closest("div").css("width","50%");var f=document.getElementById("advDgFilterD"),e=document.getElementById("advDgFilterG"),o=document.getElementById("advDgFilterC"),s=$("input:checkbox[name=advDgFilter]"),i={};for(r=0;r<n.length;r++)i[n[r].value]=n[r];i.G=e;i.D=f;i.C=o;n.add(u).change(function(){var i=o.checked&&f.checked&&e.checked&&n.filter(":not(:checked)").length==0;i!=t[0].checked&&(t[0].checked=i,t.change())});t.click(function(){this.checked?n.add(s).filter(":not(:checked)").attr("checked",!0).change():n.add(s).filter(":checked").attr("checked",!1).change()});$("#advDgFilterD, #advDgFilterG, #advDgFilterC").initAsOption().change(function(){u[0].checked=f.checked||e.checked||o.checked;u.change()}).parent();t.click(function(){f.checked=e.checked=o.checked=this.checked});$("table.obj tr").live("checkTicketRow",function(n){if(!t.checked){var r=n.trainCode[0];return"GDCZTK".indexOf(r)!=-1?i[r].checked?void 0:(n.row.remove(),n.result=0,0):i.QT.checked?void 0:(n.row.remove(),n.result=0,0)}})})(),function(){var i='<div class="fishTimePickerPopup"><div style="line-height:130%;">根据您设置的出发或到达时间要求筛选车次。请设置开始和结束时间段。<\/div><div style="">起始时间 <select class="timeFilterFrom"><\/select><\/div><div style="">结束时间 <select class="timeFilterTo"><\/select><\/div><div style="text-align:center;margin-top:10px;"><button type="button" class="flat_button">全天<\/button><\/div><\/div>',n=$("#startTime"),t=n.parent().prev();n.hide();n.parent().addClass("fishTimeRangePicker");n.before('<div class="fishTimeRangePicker"><a href="javascript:;" style="border-color: #79CC7C;background-color: #DEFDDD;"><span>0-24<\/span>点到站<\/a>'+i+"<\/div>").parent().css("width","120px");t.css("width","120px").html('<div class="fishTimeRangePicker"><a href="javascript:;" style="border-color: #7986CC;background-color: #DDE9FD;" data-trigger="1"><span>0-24<\/span>点发车<\/a>'+i+"<\/div>");var r=function(){for(var n=0;n<25;n++)this.options[this.options.length]=new Option((n<10?"0":"")+n+":00",n);this.id.indexOf("2")!=-1&&(this.selectedIndex=24)},u=0,f=24,e=0,o=24,s=function(){var h=$(this).closest("div.fishTimePickerPopup"),r=h.find("select"),t=parseInt(r.eq(0).val()),i=parseInt(r.eq(1).val()),s;if(t>i){r.eq(0).attr("id")==this.getAttribute("id")?r.eq(0).val(i).change():r.eq(1).val(t).change();return}s=h.closest("td").find("a");s.find("span").html(t+"-"+i);s.attr("data-trigger")=="1"?(u=t,f=i,t>=0&&i<=6?n.val("00:00--06:00"):t>=6&&i<=12?n.val("06:00--12:00"):t>=12&&i<=18?n.val("12:00--18:00"):t>=18&&i<=24?n.val("18:00--24:00"):n.val("00:00--24:00")):(e=t,o=i)};t.find("select.timeFilterTo, select.timeFilterFrom").each(function(n,t){t.setAttribute("id","timeFilterFrom"+(n+1));t.setAttribute("name","timeFilterFrom"+(n+1));r.call(t)}).change(s).initAsOption();t.find("button").click(function(){var n=$(this).closest("div.fishTimePickerPopup");n.find("select:eq(0)").val("0").change();n.find("select:eq(1)").val("24").change()});n.parent().find("select.timeFilterTo, select.timeFilterFrom").each(function(n,t){t.setAttribute("id","timeFilterTo"+(n+1));t.setAttribute("name","timeFilterTo"+(n+1));r.call(t)}).change(s).initAsOption();n.parent().find("button").click(function(){var n=$(this).closest("div.fishTimePickerPopup");n.find("select:eq(0)").val("0").change();n.find("select:eq(1)").val("24").change()});$("table.obj tr").live("checkTicketRow",function(n){var t=parseInt(/0*(\d+):/.exec(n.fromTime)[1]),i=parseInt(/0*(\d+):/.exec(n.toTime)[1]);if(t<u||t>=f||i<e||i>=o)return n.row.remove(),n.result=0,0})}(),function(){$("table.obj tr").live("checkTicketRow",function(n){var t=n.row.find("td:eq(1), td:eq(2)");t.each(function(){var n=$(this),t=(/<img[^>]+>(\s|&nbsp;)?/i.exec(n.html())||[])[0]||"";n.html(t+$.trim(n.text()).split(/\s+/).join("<br />"))})})}(),function(){mygrid.setColWidth(0,60);mygrid.setColWidth(1,70);mygrid.setColWidth(2,70);for(var n=4;n<15;n++)mygrid.setColWidth(n,50)}(),function(){var n=$("div.objbox"),i=n.find(">div"),t=$("#gridbox");$(document).bind("checkedTicket",function(){if(utility.getPref("query.autoexpand")=="1"){var r=Math.max(Math.min(i.height(),650),300)+10;n.css("height",r+"px");t.css("height",r+50+"px")}else n.css("height","300px"),t.css("height","350px")})}()}function initDirectSubmitOrder(){function i(n,t){u.removeClass().addClass(n?"fish_running":"fish_clock").html(t||(n?"正在操作中……":"等待中……"))}function r(n){a.eq(2).find("span").html(utility.getTimeInfo());a.eq(1).find("span").html(n)}function k(){f||(f=!0,v.animate({bottom:"0px"}))}function e(){f&&(f=!1,v.animate({bottom:"-100px"}))}function d(){y.removeClass("steps stepsok");y.addClass(o().length==4?"stepsok":"steps")}function p(){$("#randCode").attr("src","/otsweb/passCodeAction.do?rand=randp&"+Math.random());var n=document.getElementById("randCodeTxt");n.focus();n.select()}function o(){return document.getElementById("randCodeTxt").value}function w(){if(!document.getElementById("autoorder").checked)return[];var n=[];return $("#passengerList1 :checkbox").length||n.push("选择乘客"),$("#preseatlist input").length||n.push("设置优选席别"),o().length!=4&&n.push("填写验证码"),$("#autobookListTd input").length||n.push("设置自动预定车次"),n}function h(){window.location.replace("/otsweb/order/myOrderAction.do?method=queryMyOrderNotComplete&leftmenu=Y")}function g(i){var r;if(typeof i!="undefined"&&i){t=utility.analyzeForm(i);t.fields["orderRequest.reserve_flag"]="A";s=t.tourFlag;n=[];$.each(t.fields,function(t){(t.indexOf("orderRequest")!=-1||t.indexOf("org.")==0||t=="leftTicketStr")&&n.push(t+"="+encodeURIComponent(this))});n.push("tFlag="+t.tourFlag);var l=$("#passengerList1 :checkbox"),a=$("#preSelectSeat").val(),v=0;for(r=0;r<5;r++){if(r>=l.length){n.push("oldPassengers=");n.push("checkbox9=");continue}var u=l.eq(r).data("pasinfo"),f=u.passenger_type,e=u.passenger_id_type_code,o=u.passenger_id_no,h=u.passenger_name;clickBuyStudentTicket=="Y"||f!="3"||document.getElementById("autoorder_stu").checked||(f=1);n.push("passengerTickets="+a+","+v+","+f+","+encodeURIComponent(h)+","+e+","+encodeURIComponent(o)+","+u.mobile_no+",Y");n.push("oldPassengers="+encodeURIComponent(h)+","+e+","+encodeURIComponent(o));n.push("passenger_"+(r+1)+"_seat="+a);n.push("passenger_"+(r+1)+"_seat_detail="+v);n.push("passenger_"+(r+1)+"_ticket="+f);n.push("passenger_"+(r+1)+"_name="+encodeURIComponent(h));n.push("passenger_"+(r+1)+"_cardtype="+e);n.push("passenger_"+(r+1)+"_cardno="+o);n.push("passenger_"+(r+1)+"_mobileno="+u.mobile_no);n.push("checkbox9=Y")}}c()}function c(){i(!0,"正在检测订单状态....");utility.notify("开始自动提交订单！");utility.post("confirmPassengerAction.do?method=checkOrderInfo&rand="+o(),n.join("&")+"&randCode="+o(),"json",function(n){if("Y"!=n.errMsg||"N"==n.checkHuimd||"N"==n.check608){n.errMsg&&n.errMsg.indexOf("验证码")!=-1?(utility.notify("验证码不正确。请输入验证码！"),r("请重新输入验证码。"),p()):(i(!1,n.msg||n.errMsg),document.getElementById("autoorder").checked=!1,$("#orderForm").submit());return}l()},function(){i(!1,"网络出现错误，稍等重试");utility.delayInvoke(u,c,500)})}function l(){if(!document.getElementById("autoorder").checked){e();return}i(!0,"正在提交订单");r("正在检查队列。");var n={train_date:t.fields["orderRequest.train_date"],station:t.fields["orderRequest.station_train_code"],train_no:t.fields["orderRequest.train_no"],seat:$("#preSelectSeat").val(),from:t.fields["orderRequest.from_station_telecode"],to:t.fields["orderRequest.to_station_telecode"],ticket:t.fields.leftTicketStr};utility.get("/otsweb/order/confirmPassengerAction.do?method=getQueueCount",n,"json",function(n){n.op_2?(r("抽奖人数过多 (人数="+n.count+")"),i(!0,"抽奖人数过多"),utility.delayInvoke(u,l,500)):b()},function(){utility.delayInvoke(u,l,500)})}function b(){if(!document.getElementById("autoorder").checked){e();return}i(!0,"正在提交订单");r("已检测状态。");var t="confirmSingleForQueueOrder";s=="wc"?t="confirmPassengerInfoGoForQueue":s=="fc"?t="confirmPassengerInfoBackForQueue":s=="gc"&&(t="confirmPassengerInfoResignForQueue");utility.post("/otsweb/order/confirmPassengerAction.do?method="+t,n.join("&")+"&randCode="+o(),"json",function(n){var t=n.errMsg;if(t=="Y")r("订单提交成功"),i(!1,"彩票提交成功，请等待开奖。"),utility.notify("彩票提交成功，请等待开奖。"),h();else{if(t.indexOf("包含未付款订单")!=-1){e();alert("您有未支付订单! 等啥呢, 赶紧点确定支付去.");h();return}if(t.indexOf("重复提交")!=-1){r("TOKEN失效，刷新Token中....");$("#orderForm").submit();return}if(t.indexOf("包含排队中")!=-1){e();alert("您有排队中订单! 点确定转到排队页面");h();return}if(t.indexOf("排队人数现已超过余票数")!=-1){document.getElementById("autoorder").checked=!1;r(t);p();i(!1,"警告："+t+"，自动回滚为手动提交，请切换车次或席别，请尽快重试！");sendQueryFunc.call(clickBuyStudentTicket=="Y"?document.getElementById("stu_submitQuery"):document.getElementById("submitQuery"));return}r(t);i(!1,"未知错误："+t+"，请告知作者。");utility.notify("未知错误："+t+"，请告知作者。");document.getElementById("autoorder_autocancel").checked&&(document.getElementById("autoorder").checked=!1,$("#autoorder").change(),$("#orderForm").submit())}},function(){i(!1,"网络出现错误，稍等重试");utility.delayInvoke(u,b,2e3)})}var f,y;return;var a,u,v,n,s,t}function initLogin(){function u(n,t){var i=$("#countEle");i.removeClass().addClass(n?"fish_running":"fish_clock").html(t||(n?"正在操作中……":"等待中……"))}function n(n){y.eq(2).find("span").html(utility.getTimeInfo());y.eq(1).find("span").html(n)}function i(){u(!0,"正在抽摇摇乐……");$.ajax({url:"/otsweb/loginAction.do?method=loginAysnSuggest",method:"GET",dataType:"json",success:function(t,r,e){if(e.getResponseHeader("Set-Cookie")){n("会话被强行结束，请重试");u(!1,"请重新登录");f();return}t.randError!="Y"?utility.delayInvoke("#countEle",i,utility.getLoginRetryTime()):(n("登录幸运数字 - "+t.loginRand),$("#loginRand").val(t.loginRand),b())},error:function(t){r++;t.status==403?(n("["+r+"] 警告! 403错误, IP已被封!"),utility.delayInvoke("#countEle",i,1e4)):(n("["+r+"] 网络请求错误，重试"),utility.delayInvoke("#countEle",i,utility.getLoginRetryTime()))}})}function b(){var t={},e;($.each($("#loginForm").serializeArray(),function(){(this.name!="refundFlag"||document.getElementById("refundFlag").checked)&&(t[this.name]=this.value)}),t["loginUser.user_name"]&&t["user.password"]&&t.randCode&&t.randCode.length==4)&&(utility.setPref("__un",t["loginUser.user_name"]),$("#keepInfo")[0].checked&&utility.setPref("__up",t["user.password"]),e=$.extend(new $.Event("userlogin"),{user:t}),$(document).trigger(e),$("#sellInfo").hide(),$("#tipScript").show(),u(!0,"正在登录中……"),$.ajax({type:"POST",url:"/otsweb/loginAction.do?method=login",data:t,timeout:1e4,dataType:"text",success:function(t){if(msg=utility.getErrorMsg(t),t.indexOf("请输入正确的验证码")>-1)n("验证码不正确"),u(!1,"请重新输入验证码。"),f(),$("#randCode").closest("td").append("<div class='loginError' style='color:red;'>验证码不正确<\/div>");else if(msg.indexOf("密码")>-1||msg.indexOf("登录名")>-1||msg.indexOf("邮箱")!=-1)n(msg),u(!1,"请重新输入。"),f(),$("#"+(msg.indexOf("密码")!=-1?"password":"UserName")).parent().append("<div class='loginError' style='color:red;'>"+msg+"<\/div>");else if(msg.indexOf("锁定")>-1)n(msg),u(!1,"请重新输入。"),f(),alert(msg);else if(t.indexOf("欢迎您登录")!=-1){utility.notify("登录成功，开始查询车票吧！");var r=parent.document.getElementById("loginsubmit");r==null&&(parent.$("body").append("<form action='/otsweb/order/querySingleAction.do' target='main' method='get' id='loginsubmit'><input type='hidden' name='method' value='init' /><\/form>"),r=parent.document.getElementById("loginsubmit"));window.submitReport(46);setTimeout(function(){r.submit()},2e3)}else n(msg),utility.delayInvoke("#countEle",i,utility.getLoginRetryTime())},error:function(t){r++;t.status==403?(n("["+r+"] 警告! 403错误, IP已被封!"),utility.delayInvoke("#countEle",i,1e4)):(n("["+r+"] 网络请求错误，重试"),utility.delayInvoke("#countEle",i,utility.getLoginRetryTime()))}}))}function k(){if(!s){$("div.loginError").remove();var n=$("#UserName").val();if(n){if(utility.regInfo.bindAcc&&utility.regInfo.bindAcc.length&&utility.regInfo.bindAcc[0]&&$.inArray(n,utility.regInfo.bindAcc)==-1&&utility.regInfo.bindAcc[0]!="*"){alert("很抱歉，12306订票助手的授权许可已绑定至【"+utility.regInfo.bindAcc.join()+"】，未授权用户，助手停止运行，请手动操作。\n您可以在登录页面下方的帮助区点击【重新注册】来修改绑定。");return}p++;utility.setPref("_sessionuser",$("#UserName").val());s=!0;i()}}}function f(){$("#img_rrand_code").click();$("#randCode").val("")[0].select();s=!1}function w(n){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+n)}var l=utility.getTopWindow(),e,a,t,o,v,h,c;l.utility.allPassengers&&(l.utility.allPassengers=null);window.submitReport(45);e=!1;try{e=(top.location+"").indexOf("dynamic.12306.cn")!=-1}catch(d){}e||($("#loginForm table tr:first td:last").append("<a href='https://dynamic.12306.cn/otsweb/' target='_blank' style='margin-left:45px;font-weight:bold;color:red;'>点击全屏订票<\/a>"),utility.getPref("login.fullscreenAlert")||(utility.setPref("login.fullscreenAlert",1),utility.notify("强烈建议你点击界面中的『点击全屏订票』来全屏购票，否则助手有些提示消息您将无法看到！")));a=new Date;$(".enter_right").empty().append("<div class='enter_enw'><div class='enter_rtitle titlebar' style=\"margin: 40px 0px 10px 0px; font-size: 20px; font-family: 微软雅黑; font-weight:bold; background:url('data:image/gif;base64,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') no-repeat left center;text-shadow: 1px 1px 3px #ccc; text-indent: 40px; line-height:30px;\">嘿，又遇订票助手<\/div><div class='enter_rfont'><ul id='tipScript' style='display:none;'><li class='fish_clock' id='countEle' style='font-weight:bold;'>请输入登录信息<\/li><li style='color:green;'><strong>操作信息<\/strong>：<span>休息中<\/span><\/li><li style='color:green;'><strong>最后操作时间<\/strong>：<span>--<\/span><\/li><\/ul><ul id='sellInfo' style='line-height:130%;'><li style='font-weight:bold;border: 1px solid gray;background-color: #FFFFA9;padding: 10px;text-align: center;margin-bottom: 5px;'>本日起售【<strong style='color:red;'>"+utility.formatDate(w.call(a,19))+"<\/strong>】车票<\/li><li>网上和电话订票提前20天，代售点和车站提前18天。【<a href='http://www.12306.cn/mormhweb/zxdt/tlxw_tdbtz56.html' target='_blank'>以公告、车站公告为准<\/a>】<\/li><li style='padding:10px 0 10px 0;font-weight:bold;'>根据乘车日期推算预售期<\/li><li><\/li><li style='padding-bottom:5px;'>乘车日期：<input type='date' id='cdate' /><\/li><\/ul><ul id='updateInfo'><li id=\"sysnoticeTitle\" style=\"margin-top: 10px;border-top: 1px dotted #ccc;color: blue;font-weight: bold;\"><\/li><li id=\"sysnoticeContent\" style=\"line-height:120%;\"><\/li><li><\/li><\/ul><\/div><\/div>");t=[];t.push("<div class='outerbox' style='margin:20px 0;'><div class='box' style='margin:0;width:auto;line-height:18px;'>");t.push('<div style="background-color:#e6e6e6;padding:5px;color:#777;">12306订票助手 '+utility.spec+'<\/div><div style="padding:10px;"><div><strong>自动更新<\/strong><span style="margin-left:20px;" id="updatesFound">正在检测更新...<\/span><\/div><div>');t.push('<strong>当前版本<\/strong><span style="margin-left:20px;">已许可于：<strong>'+utility.regInfo.name+"<\/strong>");t.push(", ");utility.regInfo.bindAcc&&(utility.regInfo.bindAcc[0]&&utility.regInfo.bindAcc[0]!="*"?t.push("许可12306帐户：<strong>"+utility.regInfo.bindAcc+"<\/strong>, "):t.push("许可12306帐户：<em>无限<\/em>, "));t.push("类型: <strong>"+utility.regInfo.typeDesc+"<\/strong>");t.push(", 版本：<strong>"+window.helperVersion+"<\/strong>【<a href='javascript:;' class='reSignHelper'>重新注册<\/a>】<\/span> | <a href='http://www.fishlee.net/soft/44/' style='color:#4D4DB6;' target='_blank'>助手主页<\/a> | <a href='http://bbs.fishlee.net/' target='_blank' style='color:#4D4DB6;'>助手论坛<\/a> | <a href='http://www.fishlee.net/soft/44/announcement.html' style='color:#4D4DB6;' target='_blank'>免责声明<\/a> | <a style='font-weight:bold;color:red;' href='http://www.fishlee.net/soft/44/donate.html' target='_blank'>捐助作者<\/a> | <a href='http://t.qq.com/ccfish/' style='color:#4D4DB6;' target='_blank'>腾讯微博<\/a> | <a href='http://weibo.com/imcfish/' style='color:#4D4DB6;' target='_blank'>新浪微博<\/a><\/div><\/div><\/div><\/div>");$("div.enter_help").before(t.join(""));o=$("#loginForm");v=o.find("tr");v.eq(1).find("td:last").html('<label><input type="checkbox" id="keepInfo" '+(utility.getPref("__un")&&!utility.getPref("__up")?"":"checked='checked'")+" />记住密码<\/label>");$("#loginForm td:last").html('<label><input type="checkbox" checked="checked" id="autoLogin" name="autoLogin" /> 自动登录<\/label>');$("#loginForm td:last").find("input, select").initAsOption();$("#keepInfo").change(function(){this.checked||localStorage.getItem("__up")!=null&&(localStorage.removeItem("__up"),alert("保存的密码已经被删除！"))}).attr("checked",!(utility.getPref("__un")&&!utility.getPref("__up")));o.submit(function(){utility.setPref("_sessionuser",$("#UserName").val())});var y=$("#tipScript li"),p=1,r=0,s=!1;h=utility.getPref("__un");h&&$("#UserName").val(h);$("#password").val(utility.getPref("__up")||"");$("#randCode").keyup(function(n){$("#autoLogin")[0].checked&&(n=n||event,(n.charCode==13||$("#randCode").val().length==4)&&k())});c=function(){var n=this.valueAsDate?this.valueAsDate:new Date(this.value);n&&!isNaN(n.getFullYear())&&$(this).parent().prev().html("起售日期：<strong style='color:red;'>"+utility.formatDate(w.call(n,-19))+"<strong>")};$("#cdate").click(c).change(c),function(){var u="login_ulist",n,t,r,i;$("#UserName").css({width:"204px","line-height":"28px",position:"absolute",top:"5px",left:"0","z-index":"101"}).parent().css({position:"absolute"}).end().after('<select id="ulist" style="width: 227px;position: absolute;left: 0px;top: 5px;line-height: 30px;height: 28px;z-index: 100;"><option value="">===========[请选择]===========<\/option><\/select><button class="lineButton" id="btnDeleteUser" type="button" style="position:absolute;top:5px;left:230px;width:45px;line-height:20px;">删除<\/button>');n=utility.parseJSON(utility.getPref(u)||"{}");t=$("#ulist");for(r in n)t.append("<option value='"+r+"'>"+r+"<\/option>");i=function(){utility.setPref(u,JSON.stringify(n))};$(document).bind("userlogin",function(t){
//!data["loginUser.user_name"] || !data["user.password"]
n[t.user["loginUser.user_name"]]=document.getElementById("keepInfo").checked?t.user["user.password"]:"";i()});$("#btnDeleteUser").click(function(){var r=$("#UserName").val();r&&n[r]&&confirm("确定要删除保存的用户【"+r+"】吗？")&&(t.find("option[value="+r+"]").remove(),$("#UserName, #password").val(""),delete n[r],i())});t.change(function(){var i=t.val();i&&($("#UserName").val(i).change(),$("#password").val(n[i]).change(),t.val(""),n[i]?document.getElementById("randCode").select():document.getElementById("password").select())});$("#keepInfo").change(function(){if(!this.checked){for(var t in n)n[t]="";i()}})}()}function initPayOrder(){$("div.error_text").length>0&&(utility.notify("页面出错，稍后自动刷新！"),setTimeout(function(){self.location.reload()},3e3));return;var n,t,i}function initAdvancedTicketQuery(){function t(t){var i=[],r,u;for(i.push("<tr trainCode='"+t.trainNo+"'><td>"+t.date+"<\/td><td>"+t.trainNo+"<\/td><td><div>"+t.fromName+"<\/div><div>"+t.fromTime+"<\/div><\/td><td><div>"+t.toName+"<\/div><div>"+t.toTime+"<\/div><\/td><td>"+t.elapseTime+"<\/td>"),r=0;r<11;r++)i.push("<td><\/td>");i.push("<td><a href='javascript:;' class='book'>预定<\/a><a href='javascript:;' class='delete'>删除<\/a><\/td>");i.push("<\/tr>");u=$(i.join(""));n.before(u);u.data("train",t)}function i(){var t=n.prevAll("tr").filter(":not(:last)"),i=$.map(t,function(n){return $(n).data("train")});utility.setPref("advQueryTrainList",utility.toJSON(i))}var n;return}function checkUpdate(){if(location.pathname=="/otsweb/"||location.pathname=="/otsweb/main.jsp")if(utility.isChrome||utility.isSogou||utility.isMaxthon||utility.isFirefox){var n="";utility.isMaxthon?n="maxthon":utility.isSogou?n="sogou":utility.isLieBaoEdition?n="lbintel":utility.isChrome?n="chrome":utility.isFirefox&&(n="firefox");runAjax("http://www.fishlee.net/service/update/44/version"+(n?"_"+n:"")+".js","GET",null,"text",null,function(n){var t,i;eval(n);t={compatibleVersion:version_compatibleVersion||"",compatibleMessage:version_compatibleMessage||"",success:!0,v:version_12306_helper,updates:version_updater,announcement:version_announcement||"",announcementTitle:version_announcement_title||"",foundnew:!1};t.compatibleVersion&&(t.compatibleDisplay=compareVersion(version,t.compatibleVersion)<0&&t.compatibleMessage);console.log("[12306订票助手][INFO] 更新检查：当前助手版本="+version+"，新版本="+version_12306_helper);compareVersion(version,version_12306_helper)<0&&(t.foundnew=!0,!utility.isLiebaoIntel&&confirm("订票助手已发布新版 【"+version_12306_helper+"】，为了您的正常使用，请及时更新!是否立刻更新？\n\n本次更新内容如下：\n"+version_updater.join("\n"))&&(self.location=utility.getUpdateUrl()));i=document.createElement("script");i.textContent="window.cn12306update="+buildObjectJavascriptCode(t);document.head.appendChild(i)},function(){console.log("[12306订票助手][ERROR] 助手检测更新失败");var n=document.createElement("script");n.textContent="window.cn12306update="+buildObjectJavascriptCode({success:!1});document.head.appendChild(n)})}else unsafeInvoke(function(){$("body").append('<iframe id="checkVersion" width="0" height="0" style="visibility:hidden;" src="http://static.fishlee.net/content/scriptProxy.html?script=http://static.fishlee.net/content/images/apps/cn12306/checkVersion.js&spec=&v='+window.helperVersion+'"><\/iframe>')});else location.pathname=="/otsweb/loginAction.do"?unsafeInvoke(function(){var i=$("#sysnoticeTitle"),r=$("#sysnoticeContent"),n=$("#updatesFound"),t=utility.getTopWindow(),u=setInterval(function(){if(typeof t.cn12306update!="undefined"){var f=t.cn12306update;window.clearInterval(u);i.html(f.announcementTitle);r.html(f.announcement);f.success?f.foundnew?n.html("<a href='"+utility.getUpdateUrl()+"' style='color:blue;' target='_blank'>点此更新最新版助手(版本"+f.v+")！<\/a>").css({color:"blue","font-weight":"bold"}):n.html("您正在使用最新版订票助手["+f.v+"] :)").css({color:"gray"}):n.html("<a href='http://www.fishlee.net/soft/44/download.html' target='_blank'>检测更新时发生错误，点此查看官方主页下载<\/a>").css({color:"red","font-weight":"bold"})}},1e3)}):unsafeInvoke(function(){var n=utility.getTopWindow(),t=setInterval(function(){var i,r;typeof n.cn12306update!="undefined"&&(i=n.cn12306update,window.clearInterval(t),i.success&&i.foundnew&&(r=document.createElement("div"),r.innerHTML='<div style="position:fixed;z-index:1000;left:20px;top:20px;padding: 10px;background-color: #F2FFF5;border: 1px solid rgb(150, 201, 150);"><a href="'+utility.getUpdateUrl()+'" style="color: rgb(81, 119, 74);" target="_blank">点此更新最新版助手(版本'+i.v+")！<\/a><\/div>",document.body.appendChild(r)),i.compatibleDisplay&&$("body").prepend("<div style='opacity:0.9;z-index:999; position:fixed; left:-280px; top:0px; width: 560px;margin-left:50%; color:#8A0023;border:1px solid #8A0023;line-height: 20px;background: -webkit-linear-gradient(#FFE4EA, #FFC3D1);background: -moz-linear-gradient(#FFE4EA, #FFC3D1);padding: 5px;'>"+i.compatibleMessage+"<\/div>"))},1e3)})}function compareVersion(n,t){for(var r=n.split("."),u=t.split("."),o=Math.min(r.length,u.length),f,e,i=0;i<o;i++){if(f=parseInt(r[i]),e=parseInt(u[i]),f<e)return-1;if(f>e)return 1}return r.length>u.length?1:r.length<u.length?-1:0}function runAjax(n,t,i,r,u,f,e){var c,l,h,a,y,o,v,s;if(t=="GET"&&i){h=[];for(s in i)h.push(s+"="+encodeURIComponent(i[s]));c=h.join("&");l=/(\?)(.*)+$/i.exec(n);l?l[2]||(n+="&"+c):n+="?"+c}if(u=u||{},typeof GM_xmlhttpRequest!="undefined"){if(t=="POST"&&i){h=[];for(s in i)h.push(s+"="+encodeURIComponent(i[s]));i=h.join("&")}a=function(n){for(var i=/([a-z0-9-_]+):\s*([^\r\n]+)/gi,t={};i.exec(n);)t[RegExp.$1]=RegExp.$2;return t};y={url:n,method:t,data:i,onload:function(n){var t=a(n.responseHeaders);f&&f.call({status:n.status,reponseText:n.reponseText,reponse:r=="json"?n.responseJSON:n.responseText,headers:t,getHeader:function(n){return t[n]}},r=="json"?n.responseJSON:n.responseText)},onerror:function(n){var t=a(n.responseHeaders);e&&e.call({status:n.status,reponseText:n.reponseText,reponse:r=="json"?n.responseJSON:n.responseText,headers:t,getHeader:function(n){return t[n]}},r=="json"?n.responseJSON:n.responseText)},headers:u.headers};GM_xmlhttpRequest(y)}else{if(o=new window.XMLHttpRequest,o.open(t,n,!0),u.mime&&o.overrideMimeType(u.mime),u.headers&&utility.isChrome)for(s in u.header)o.setRequestHeader("Fish-"+s,u.header[s]);if(o.onreadystatechange=function(){if(o.readyState==4)if(o.staus==0||o.status>=400)e&&e.call({status:o.status,reponseText:o.reponseText,reponse:o.response,getHeader:o.getResponseHeader,headers:o.getAllResponseHeaders()},o.response);else{var n=r=="json"?JSON.parse(o.responseText):o.responseText;f&&f.call({status:o.status,reponseText:o.reponseText,reponse:n,getHeader:o.getResponseHeader,headers:o.getAllResponseHeaders},n)}},t=="POST"){v=new FormData;for(s in i)v.append(s,i[s]);i=v}o.send(i)}}function checkDefaultOption(){window.localStorage["query.autoexpand"]||window.localStorage.setItem("query.autoexpand","1")}function mapTabIndex(n){for(var i,t=0;t<n.length;t++)i=document.getElementById(n[t]),i&&(i.tabIndex=t+1)}function initReport(){var n=function(n,t){t=t||"";t instanceof Array&&(t=t.join("-"));t=version+"-r1-"+t;utility.isLieBaoEdition&&runAjax("http://liebao.tjweb.ijinshan.com/click/__infoc.gif?actionname=liebao_80&ver="+version+"&type="+n+"&value1="+t+"&_="+Math.random(),"GET",null,"text");runAjax("http://service.fishlee.net/report/44/?t="+n+"&d="+(utility.isMaxthon?"mx":utility.isSogou?"sg":utility.isLieBaoEdition?"lb":utility.isFirefox?"ff":utility.isChrome?"cm":"na")+"-"+t,"POST",null,"text")};document.addEventListener("report",function(t){var i=t.detail;n(i.type,i.value)});window.submitReport=function(n,t){try{utility.getTopWindow().document.dispatchEvent(new CustomEvent("report",{detail:{type:n,value:t}}))}catch(i){}};unsafeInvoke(function(){window.submitReport=function(n,t){try{utility.getTopWindow().document.dispatchEvent(new CustomEvent("report",{detail:{type:n,value:t}}))}catch(i){}}})}var version="5.3.2",updates=["* 修正黑名单过滤和时间过滤存在的BUG","* 改进登录信息提示","* 改进刷票信息提示","* 改进兼容性检测","* 其它部分修复"],faqUrl="http://www.fishlee.net/soft/44/faq.html",utility_emabed=!1,compVersion="5.94",isDebug=(compressFunc+"").indexOf("false")!=-1,utility={appid:"",configTab:null,icon:"http://www.12306.cn/mormhweb/images/favicon.ico",regInfo:null,disabledFeaturesCache:null,isFirefox:!1,isWebKit:!1,isChrome:!1,isLieBaoEdition:!1,isSogou:!1,isMaxthon:!1,parseJSON:function(n){if(JSON&&JSON.parse)return JSON.parse(n);alert("您的浏览器版本过低，请升级浏览器！")},toJSON:function(n){if(JSON&&JSON.parse)return JSON.stringify(n);alert("您的浏览器版本过低，请升级浏览器！")},disabledFeatures:function(){return utility.disabledFeaturesCache||(utility.disabledFeaturesCache=(utility.getPref("disabled")||"").split("|")),utility.disabledFeaturesCache},isfeatureDisabled:function(n){return $.inArray(n,utility.disabledFeatures())!=-1},disableFeature:function(n){n&&utility.disabledFeaturesCache.push(n);utility.setPref("disabled",utility.disabledFeaturesCache.join("|"))},clearFeatrueDisabled:function(){utility.setPref("disabled","");utility.disabledFeaturesCache=[]},trim:function(n){return typeof $!="undefined"?$.trim(n):n.replace(/(^\s+|\s+$)/g,"")},getTopWindow:function(){try{return parent==self?self:parent.window.utility.getTopWindow()}catch(n){return self}},init:function(){$.each([[0,"enableMusicPromptOnAutoRefresh",!0],[0,"musicPromptLoop",!0],[0,"enableRefreshWaitOClock",!0],[2,"musicPath","http://static.fishlee.net/resources/audio/music2.ogg"],[1,"baseAutoRefreshDelay",5],[1,"delayAfterHourStop",3]],function(){this[0]==0?(utility.__defineGetter__(this[1],function(n,t){return function(){return(utility.getPref(n)||t)=="1"}}(this[1],this[2])),utility.__defineSetter__(this[1],function(n){return function(t){return utility.setPref(n,t?"1":"0")}}(this[1]))):this[0]==1?(utility.__defineGetter__(this[1],function(n,t){return function(){return parseInt(utility.getPref(n)||t)}}(this[1],this[2])),utility.__defineSetter__(this[1],function(n){return function(t){return utility.setPref(n,t)}}(this[1]))):this[0]==2?(utility.__defineGetter__(this[1],function(n,t){return function(){return utility.getPref(n)||t}}(this[1],this[2])),utility.__defineSetter__(this[1],function(n){return function(t){return utility.setPref(n,t)}}(this[1]))):this[0]==3&&(utility.__defineGetter__(this[1],function(n,t){return function(){return utility.parseJSON(utility.getPref(n)||t)}}(this[1],this[2])),utility.__defineSetter__(this[1],function(n){return function(t){return utility.setPref(n,utility.toJSON(t))}}(this[1])));utility.__defineGetter__("spec",function(){return utility.isLiebaoIntel?"(猎豹专版)":""})});$.extend({any:function(n,t){var i=!1;return $.each(n,function(n,r){return i=t.call(this,n,r),i?!1:void 0}),i},first:function(n,t){var i=null;return $.each(n,function(n,r){return i=t.call(this,n,r),i?!1:void 0}),i},inArrayEx:function(n,t,i,r){if(typeof i=="function"&&(r=i,i=0),typeof r!="function")return $.inArray(n,t,i);for(var u=i;u<t.length;u++)if(r(t[u],n))return u;return-1},prompt:function(n){return n=$.extend({buttons:[],title:"10306订票助手",ele:null,content:null,onCancel:function(){},closeOnClick:!0,to:null},n),function(n){var t,i,u,r,f;this.options=n;t=this;i=$("#fishPromptDlg");i.length||($("body").append('<div id="fishPromptDlg" class="fishDialog"><div class="fishDialogTitle"><\/div><div class="fishDialogContent"><\/div><div class="fishDialogControls"><button class="close_button fish_button">关闭<\/button><\/div><\/div>'),i=$("#fishPromptDlg"));u=i.find(".fishDialogControls");u.find(":not(.close_button)").remove();$.each(this.options.buttons,function(){var n=$('<button class="fish_button '+this.cssClass+'">'+this.text+"<\/button>"),i=this.handler;i&&n.click(function(){t.options.closeOnClick&&t.close();i.call(t,this)});u.prepend(n)});i.find(".fishDialogTitle").html(this.options.title);r=i.find(".fishDialogContent");this.options.content?(r.html(this.options.content),i.width(500)):(i.css("width","auto"),f=r.children(),$("body").append(f.hide()),r.width(this.options.ele.innerWidth()),r.append(this.options.ele),this.options.ele.show());this.dialog=i.fishDialog({to:t.options.to});this.close=function(){t.dialog.closeDialog();t.options.onClose&&t.options.onClose.call(t)}}(n)}});$.fn.extend({fishDialog:function(n){var t="fs_dlg_opt",i=this;return i.data(t)?i.data(t):function(n){var i=this,h,l;i.options=$.extend({maskOpacity:.5,bindControl:null,removeDialog:this.attr("autoCreate")=="1",onClose:null,animationMove:20,speed:"fast",fx:"linear",show:"fadeInDown",hide:"fadeOutUp",onShow:null,timeOut:0,to:null,mask:!0},n);var r,u,e,o,s,f,v=$("body"),a=document.body.scrollLeft+document.documentElement.clientWidth,c=document.body.scrollTop+document.documentElement.clientHeight;return i.calcLocation=function(){if(r="50%",u="50%",e=i.width(),o=i.height(),s=-e/2,f=-o/2-i.options.animationMove,i.options.to){var n=i.options.to.position();r=n.top;u=n.left;r+o>=c&&(r=c-o-1);u+e>=a&&(u=a-e-1);u+="px";r+="px";s=0;f=-i.options.animationMove}},i.calcLocation(),i.options.mask&&(h=document.getElementById("fishDialogMask"),h||($("body").append("<div id='fishDialogMask' class='fishDialogMask'><\/div>"),h=document.getElementById("fishDialogMask")),$(h).css({height:c+"px",opacity:0}).show().animate({opacity:i.options.maskOpacity},"fast","linear")),i.css({position:i.options.parent||i.options.to?"absolute":"fixed",left:u,top:r,"margin-left":s+"px","margin-top":f-i.options.animationMove+"px","z-index":"10000"}),i.changeLoadingIcon=function(n){return i.removeClass().addClass("loadingDialog loadicon_"+(n||"tip")),i},i.autoCloseDialog=function(n){return setTimeout(function(){i.closeDialog()},n||2500),i},i.setLoadingMessage=function(n){return i.find("div").html(n),i},i.closeDialog=function(){return $(".close_button",i).unbind("click",i.closeDialog),i.removeData(t),i.animate({marginTop:f+i.options.animationMove+"px",opacity:"hide"},i.options.speed,i.options.fx,function(){i.options.bindControl&&i.options.bindControl.enable();i.options.onClose&&i.options.onClose.call(i);i.options.removeDialog&&i.options.remove()}),$("#fishDialogMask").animate({opacity:"hide"},"fast","linear"),i},$(".close_button",i).click(i.closeDialog),i.options.timeOut>0&&(l=i.options.onShow,i.options.onShow=function(){setTimeout(function(){i.closeDialog()},i.options.timeOut);l!=null&&l.call(i)}),i.options.bindControl&&i.options.bindControl.disable(),i.animate({marginTop:f+"px",opacity:"show"},i.options.speed,i.options.fx,function(){i.options.onShow&&i.options.onShow.call(i)}),i.data(t,i),i.bind("sizeChanged",function(){i.calcLocation();i.animate({left:u,top:r,"margin-left":s+"px","margin-top":f-i.options.animationMove+"px"},i.options.speed,i.options.fx)}),this}.call(i,n)},initAsOption:function(n){return n=n||"",this.each(function(){var u=this.tagName,f=this.getAttribute("id"),e=this.getAttribute("type")||"",o=this.dataset.islist=="1",i=$(this),r=n+"_"+f,t=window.localStorage.getItem(r);u=="SELECT"&&o&&(t&&(t=t.indexOf("\t")!=-1?t.split("\t"):t.split("|"),$.each(t,function(){this.options[this.options.length]=new Option(this,this)})),i.bind("save",function(){window.localStorage["list_"+this.getAttribute("name")]=utility.getOptionArray(this).join("\t")}));i.attr("data-skey",r);t&&(e=="checkbox"?(this.checked=t=="1",i.change()):i.val(t).change())}).change(function(){var t=$(this),n=t.attr("data-skey");n&&(this.getAttribute("type")=="checkbox"?window.localStorage.setItem(n,this.checked?"1":"0"):window.localStorage.setItem(n,t.val()))}),this}});utility.isChrome&&$(document).ajaxSend(function(n,t,i){i.refer&&t.setRequestHeader("TRefer",i.refer)})},arrayTake:function(n,t){for(var r=[],i=0;i<t&&i<n.length;)r.push(n[i++]);return r},showLoginIE:function(){for(var f=document.cookie,r=f.split("; "),i="javascript:",u=[],n,t=0;t<r.length;t++)(n=r[t].split("="),n.length<2||n[0].indexOf("helper.")!=-1)||u.push('document.cookie="'+n[0]+"="+n[1]+'";');i+=u.join("");i+="self.location.reload();";$("#LoginIECode").val(i)},formatData:function(n){var t,i;if(!n)return"(null)";if(typeof n=="string")return n;t=[];for(i in n)t.push('"'+i+'":"'+(this[i]+"").replace(/(\r|\n|")/g,function(n){"\\"+n})+'"');return"{"+t.join(",")+"}"},notify:function(n,t,i){var r=utility.getTopWindow(),u;r==self?(u=new CustomEvent("notify",{detail:{msg:n,title:t||"",timeout:i||""}}),document.body.dispatchEvent(u)):r.utility.notify(n,t,i)},setPref:function(n,t){window.localStorage.setItem(n,t)},getPref:function(n){return window.localStorage.getItem(n)},unsafeCallback:function(n){typeof unsafeInvoke=="undefined"?n():unsafeInvoke(n)},getTimeInfo:function(){var n=new Date;return n.getHours()+":"+(n.getMinutes()<10?"0":"")+n.getMinutes()+":"+(n.getSeconds()<10?"0":"")+n.getSeconds()},getErrorMsg:function(n){var t=n.match(/var\s+message\s*=\s*"([^"]*)/);return t&&t[1]?t[1]:"&lt;未知信息&gt;"},delayInvoke:function(n,t,i){var u,r;n=n||"#countEle";u=typeof n=="string"?$(n):n;i<=0?(u.html("正在执行").removeClass("fish_clock").addClass("fish_running"),t()):(r=Math.floor(i/100)/10+"",r.indexOf(".")==-1&&(r+=".0"),u.html(r+" 秒后再来!...").removeClass("fish_running").addClass("fish_clock"),setTimeout(function(){utility.delayInvoke(n,t,i-500)},500))},addOption:function(n,t,i){n.options[n.options.length]=new Option(t,i)},getOptionArray:function(n){return $.map(n.options,function(n){return n.value})},inOptionList:function(n,t){for(var i=0;i<n.options.length;i++)if(n.options[i].value==t)return!0;return!1},getAudioUrl:function(){return window.localStorage.audioUrl||"http://static.fishlee.net/resources/audio/music2.ogg"},getFailAudioUrl:function(){return"http://static.fishlee.net/resources/audio/music3.ogg"},playFailAudio:function(){window.Audio&&new Audio(utility.getFailAudioUrl()).play()},resetAudioUrl:function(){window.localStorage.removeItem("musicPath")},parseDate:function(n){return/(\d{4})[-/](\d{1,2})[-/](\d{1,2})/.exec(n),new Date(RegExp.$1,RegExp.$2-1,RegExp.$3)},getDate:function(n){return new Date(n.getFullYear(),n.getMonth(),n.getDate())},formatDate:function(n){var t=n.getFullYear();return t+"-"+utility.formatDateShort(n)},formatDateShort:function(n){var t=n.getMonth()+1,n=n.getDate();return(t>9?t:"0"+t)+"-"+(n>9?n:"0"+n)},formatTime:function(n){function t(n){return n<10?"0"+n:n}return utility.formatDate(n)+" "+t(n.getHours())+":"+t(n.getMinutes())+":"+t(n.getSeconds())},addTimeSpan:function(n,t,i,r,u,f,e){return new Date(n.getFullYear()+t,n.getMonth()+i,n.getDate()+r,n.getHours()+u,n.getMinutes()+f,n.getSeconds()+e)},serializeForm:function(n){var r={},t=n.serializeArray(),i;for(i in t)typeof r[t[i].name]=="undefined"?r[t[i].name]=t[i].value:r[t[i].name]+=","+t[i].value;return r},getSecondInfo:function(n){var t="",i=parseInt(n/3600),r;return i>0&&(t=i+"小时",n=n%3600),r=parseInt(n/60),r>=1?(t=t+r+"分",n=n%60):i>=1&&n>0&&(t=t+"0分"),n>0&&(t=t+n+"秒"),t},post:function(n,t,i,r,u,f,e){var o=function(n){var t=utility.checkResponse(n);t<1?(alert("警告："+(t==0?"操作失败":"系统已强制退出登录")+"，可能是系统已升级。"+(f?"\n为了保证您的安全，功能【"+f+"】已被自动禁用，请重新登录。\n在助手升级后，功能将会被自动重新开启。\n\n请重新登录。":"")),utility.disableFeature(f),t==-1&&(self.location="/otsweb/loginAction.do?method=init")):u&&u.apply(this,arguments)};$.ajax({url:n,data:t,timeout:1e4,type:"POST",success:function(n,t,i){utility.checkResponse(i)<1?o(i):r&&r.apply(this,arguments)},error:o,dataType:i,refer:utility.getFullUrl(e)})},checkResponse:function(n){var t=n.responseText;return n.status==0||typeof t=="undefined"?0:!t||t.indexOf("<title>登录<\/title>")!=-1?-1:t=="-1"?0:1},get:function(n,t,i,r,u,f,e){var o=function(n){var t=utility.checkResponse(n);t<1?(alert("警告："+(t==0?"操作失败":"系统已强制退出登录")+"，可能是系统已升级或网络出错。"+(f?"\n为了保证您的安全，功能【"+f+"】已被自动禁用，请重新登录。\n在助手升级后，功能将会被自动重新开启。\n\n请重新登录。":"")),utility.disableFeature(f),t==-1&&(self.location="/otsweb/loginAction.do?method=init")):u&&u.apply(this,arguments)};$.ajax({url:n,data:t,timeout:1e4,type:"GET",success:function(n,t,i){utility.checkResponse(i)<1?o(i):r&&r.apply(this,arguments)},error:o,dataType:i,refer:utility.getFullUrl(e)})},fishTab:function(n,t){return function(n){var t=this;return n=$.extend({switchOnHover:!1,switchOnClick:!0},n),this.addClass("fishTab"),this.showTab=function(i){t.find(".current").removeClass("current");t.find("ul.tabNav li[tab="+i+"], div."+i).addClass("current");n.onShow&&n.onShow();t.trigger("sizeChanged")},t.find(".tabNav li").hover(function(){n.switchOnHover&&t.showTab($(this).attr("tab"))}).click(function(){n.switchOnClick&&t.showTab($(this).attr("tab"))}),this.showTab(t.find(".tabNav").attr("default")||t.find(".tabNav li:eq(0)").attr("tab")),this}.call(n,t)},getLoginRetryTime:function(){return parseInt(window.localStorage.getItem("login.retryLimit"))||2e3},showOptionDialog:function(n){n&&utility.configTab.showTab(n);$("#fishOption").fishDialog()},addCookie:function(n,t,i){var r=n+"="+t+"; path=/; domain=.12306.cn";i>0&&(r+="; expires="+new Date((new Date).getTime()+i*864e5).toGMTString());document.cookie=r},getCookie:function(n){for(var u=document.cookie,r=u.split("; "),i,t=0;t<r.length;t++)if(i=r[t].split("="),i[0]==n)return i[1]},setSnInfo:function(n,t){utility.setPref("helper.regUser",n);utility.setPref("helper.regSn",t);utility.addCookie("helper.regUser",n,999);utility.addCookie("helper.regSn",t,999)},verifySn:function(n,t,i){var i,u,e,r;if(t=t||utility.getPref("helper.regUser")||utility.getCookie("helper.regUser"),i=i||utility.getPref("helper.regSn")||utility.getCookie("helper.regSn"),!t&&i)return utility.verifySn2(n,i);if(!t||!i)return i={result:0,msg:"未注册",name:"基本用户",typeDesc:"基本版",type:"DEMO"},utility.isLieBaoEdition&&(i={result:0,msg:"未注册",name:"猎豹浏览器用户",typeDesc:"正式版",type:"NRML",partner:1}),i;if(utility.setSnInfo(t,i),u=i.split(","),!n&&(new Date-u[0])/6e4>5)return{result:-1,msg:"序列号注册已失效"};var o=[],s=u[0]+u[1],f=0;for(e=0;e<u[2].length;e+=4)o.push(String.fromCharCode(parseInt(u[2].substr(e,4),16)^s.charCodeAt(f))),f++,f>=s.length&&(f=0);return r=o.join(""),r={result:null,type:r.substring(0,4),name:r.substring(4)},r.result=r.name==t?0:-3,r.msg=r.result==0?"成功验证":"注册无效",r.typeDesc=r.type=="NRML"?"正式版":r.type=="GROP"?"内部版, <span style='color:blue;'>感谢您参与我们之中<\/span>!":"<span style='color:red;'>捐助版, 非常感谢您的支持<\/span>!",r},verifySn2:function(n,t){var o,s,f,h,r,u,i,t;t=utility.trim(t);try{for(o=parseInt(t.substr(0,2),16),s=t.substr(2,o),t=t.substring(2+o),f=[],i=0;i<t.length;i++)h=t.charCodeAt(i),h>=97?f.push(String.fromCharCode(h-49)):f.push(t.charAt(i));t=f.join("");var e=parseInt(t.substr(0,14),16),a=parseInt(t.substr(14,1),16),c=e.toString(16).toUpperCase()+a.toString().toUpperCase();for(t=t.substring(15),r=[],u=0,i=0;i<t.length;i+=4)r.push(String.fromCharCode(parseInt(t.substr(i,4),16)^c.charCodeAt(u))),u++,u>=c.length&&(u=0);r=r.join("").split("|");var v=r[0].substr(0,4),y=r[0].substring(4),l=r.slice(1,r.length);if(!l&&!n&&(new Date-e)/6e4>5)return{result:-1,msg:"注册码已失效， 请重新申请"};if(y!=s)return{result:-3,msg:"注册失败，用户名不匹配"};t={name:s,type:v,bindAcc:l,ticket:e,result:0,msg:"成功注册"};switch(t.type){case"NRML":t.typeDesc="正式版";break;case"GROP":t.typeDesc="内部版, <span style='color:blue;'>感谢您参与我们之中<\/span>!";break;case"DONT":t.typeDesc="<span style='color:red;'>捐助版, 非常感谢您的支持<\/span>!";break;case"PART":t.typeDesc="合作版，欢迎您的使用"}return t.regTime=new Date(e),t.regVersion=2,t}catch(p){return{result:-4,msg:"数据错误"}}},allPassengers:null,getAllPassengers:function(n,t){function r(){utility.get("/otsweb/order/confirmPassengerAction.do?method=getpassengerJson",null,"json",function(t){utility.allPassengers=t.passengerJson;n(utility.allPassengers)},function(){setTimeout(r,3e3)},"pasload","/otsweb/order/confirmPassengerAction.do?method=init")}var i,u;if(utility.allPassengers){n(utility.allPassengers);return}if(i=utility.getTopWindow(),i!=self)return i.utility.getAllPassengers(n,t);if(utility.isfeatureDisabled("pasload"))return[];utility.allPassengers=[];u=0;r()},getFullUrl:function(n){return typeof n=="undefined"||!n?"":location.protocol+"//"+location.host+n},regCache:{},getRegCache:function(n){return utility.regCache[n]||(utility.regCache[n]=new RegExp("^("+n+")$","i"))},preCompileReg:function(n){var t=$.map(n,function(n){return n.value});return new RegExp("^("+t.join("|")+")$","i")},enableLoginIE:function(){$("body").append('<button class="fish_button configLink" style="width:150px;position:fixed;right:14px;top:20px;height:35px;"tab="tabLoginIE">获取登录到IE的代码<\/button>')},analyzeForm:function(n){var t={},i=/<form.*?action="([^"]+)"/.exec(n),r;return t.action=i?RegExp.$1:"",t.fields={},r=n.match(/<input\s*(.|\r|\n)*?>/gi),$.each(r,function(){if(/name=['"]([^'"]+?)['"]/.exec(this)){var n=RegExp.$1;t.fields[RegExp.$1]=/value=['"]([^'"]+?)['"]/.exec(this)?RegExp.$1:""}}),i=/submit_form_confirm\('confirmPassenger','([a-z]+)'\)/.exec(n),i&&(t.tourFlag=RegExp.$1),t},selectionArea:function(n){var t=this,i,r;if(this.options=$.extend({comparer:null,onAdd:function(){},onRemove:function(){},onClear:function(){},onRemoveConfirm:function(){return!0},emptyText:"还没有添加任何项",syncToStorageKey:"",defaultList:null,preloadList:null},n),this.append('<div style="border:1px dotted #dbdbdb; color: #a2a2a2; background-color:#fafafa; padding-left: 5px; padding-right: 5px; display: inline-block;">'+this.options.emptyText+"<\/div>"),this.datalist=[],this.__defineGetter__("count",function(){return t.datalist.length}),this.add=function(n){if(!($.inArrayEx(n,t.datalist,0,t.options.comparer)>-1)){var r=typeof n=="string"||n instanceof String?n+"":n.text,i=$('<input type="button" class="lineButton" value="'+r+' ×" title="点击删除" />');t.append(i);i.click(t.removeByButton);t.datalist.push(n);t.syncToStorage();t.checkEmpty();t.options.onAdd.call(t,n,i)}},this.removeByButton=function(){var n=$(this),i=n.index()-1,r=t.datalist[i];t.options.onRemoveConfirm.call(t,r,n,i)&&(n.remove(),t.datalist.splice(i,1),t.syncToStorage(),t.checkEmpty(),t.options.onRemove.call(t,r,n))},this.emptyList=function(){t.datalist=[];t.find("input").remove();t.syncToStorage();t.checkEmpty();t.options.onClear.call(t)},this.isInList=function(n){return $.inArrayEx(n,t.datalist,0,t.options.comparer)>-1},this.isInRegList=function(n){for(var i,r=0;r<t.datalist.length;r++)if(i=t.datalist[r],i=typeof i=="string"||i instanceof String?i+"":i.reg||i+"",utility.getRegCache(i).test(n))return!0;return!1},this.syncToStorage=function(){t.options.syncToStorageKey&&window.localStorage.setItem(t.options.syncToStorageKey,utility.toJSON(t.datalist))},this.checkEmpty=function(){t.find("input").length?t.find("div").hide():t.find("div").show()},t.options.syncToStorageKey&&(i=t.options.preloadList,i||(i=utility.getPref(this.options.syncToStorageKey),i=i?i[0]=="["||i[0]=="{"?utility.parseJSON(i):i.split("\t"):this.options.defaultList),i))for(r in i)t.add(i[r]);return this},getUpdateUrl:function(){var n="http://www.fishlee.net/Service/Download/44/";return utility.isLieBaoEdition?n+"189/12306%E8%AE%A2%E7%A5%A8%E5%8A%A9%E6%89%8B(%E7%8C%8E%E8%B1%B9%E6%8A%A2%E7%A5%A8%E5%85%9A%E9%9B%86%E6%88%90%E7%89%88).crx":utility.isSogou?n+"68/12306_ticket_helper.sext":utility.isMaxthon?n+"62/mxaddon.mxaddon":utility.isFirefox?n+"47/12306_ticket_helper.user.js":n+"63/12306_ticket_helper.crx"},isAdvancedSupport:function(){return utility.isChrome},getTicketInfo:function(n){var i={},u=n.match(/([\dA-Za-z])\*{5}(\d{4})/gi),f,r,t;for(f in u)r=u[f][0],t=parseInt(/\*0*(\d+)/.exec(u[f])[1]),t<3e3?(i[r]=t,r=="7"?i.M=t:r=="8"&&(i.O=t)):i["0"]=t-3e3;return i},isDemoUser:function(){return utility.regInfo==null||utility.regInfo.type=="DEMO"},associateSwitch:function(){return this.change(function(){if(utility.setPref(this.id,this.checked?"1":"0"),this.dataset&&this.dataset.target){var n=$("#"+this.dataset.target);n&&(this.checked&&n.show()||n.hide())}}).each(function(){this.checked=utility.getPref(this.id)=="1"}),this.change(),this}};(function(){if(typeof window.webkitNotifications=="undefined"||typeof GM_getTab!="undefined")typeof ActiveXObject!="undefined"?alert("很抱歉，未能识别您的浏览器，或您的浏览器尚不支持脚本运行，请使用Firefox或Chrome浏览器！\n如果您运行的是Maxthon3，请确认当前页面运行在高速模式而不是兼容模式下 :-)"):typeof GM_notification=="undefined"&&typeof window.webkitNotifications=="undefined"?(alert("很抱歉，本脚本需要最新的Scriptish扩展、不支持GreaseMonkey，请禁用您的GreaseMonkey扩展并安装Scriptish！"),unsafeWindow.GM_openInTab("https://addons.mozilla.org/zh-CN/firefox/addon/scriptish/")):(utility.isFirefox=!0,initialzeAndStartup());else{if(!window.localStorage){alert("警告! localStorage 为 null, 助手无法运行. 请查看浏览器是否已经禁用 localStorage!\nFirefox请设置 about:config 中的 dom.storage.enabled 为 true .");return}if(typeof GM_openInTab!="undefined"){alert("错误：您所使用的订票助手无法正常运行，因为您在Chrome浏览器上安装了UserScript模式的脚本。\n\n请卸载您的订票助手，并下载用于Chrome的CRX版本重新安装。\n\n谷歌浏览器建议安装商店版。");GM_openInTab("http://www.fishlee.net/soft/44/download.html");return}if(utility.isWebKit=!0,typeof window.mx!="undefined"&&(utility.isMaxthon=!0),typeof sogouExplorer!="undefined"&&(utility.isSogou=!0),typeof chrome!="undefined"&&(utility.isChrome=!0),utility.isChrome){if(window.appid=utility.appid=/chrome-extension\:\/\/([^\/]+)\//.exec(chrome.extension.getURL(""))[1],appid!="bpbefagpafkfgoihbmcgeileodldkpnf"&&appid!="idjgmabfihmhmojipdkcackbihbdceno"&&appid!="iojocdfolilckogkigiahnjfmpjinobl"&&appid!="gkbheeokbgmmnbjhhlphckobccejghjn"){alert("您所使用的助手是第三方非法打包的，为了您的安全，助手拒绝运行。\n\n请卸载您的订票助手，并下载用于适用于Chrome的官方CRX版本重新安装。\n\n谷歌浏览器建议安装商店版。");chrome.tabs.create({url:"http://www.fishlee.net/soft/44/download.html"});return}chrome.extension.sendRequest({"function":"getRunTimeInfo"},function(n){var t=n.appid;utility.appid=t;utility.isLieBaoEdition=n.isLiebaoIntel;utility.isLiebaoIntel=n.isLiebaoIntel;n.isOtherInstanceExist||initialzeAndStartup()})}else initialzeAndStartup()}})()